<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=gb2312"/>
<style type="text/css"> /* <![CDATA[ */
  @import "branding/css/tigris.css";
  @import "branding/css/inst.css";
  /* ]]> */</style>
<link rel="stylesheet" type="text/css" media="print"
  href="branding/css/print.css"/>
<script type="text/javascript" src="branding/scripts/tigris.js"></script>
<title>Subversion FAQ(常见问题解答)</title>
</head>

<body>
<div class="app">

<h1>Subversion FAQ(常见问题解答)</h1>


<div class="h2"><!-- no 'id' or 'title' attribute for TOC -->
<h2>问题列表</h2>

<h4>常见问题：</h4>
<ul>
<li><a href="#why">为什么会有这样一个项目？</a></li>
<li><a href="#collab">Subversion是私有软件吗?我听说它是属于CollabNet公司的。</a></li> 
<li><a href="#stable">Subversion用在我的项目上是否足够稳定？</a></li>
<li><a href="#interop">Subversion的客户端/服务器协同工作的策略是怎样的？ </a></li>
<li><a href="#portability">Subversion可以运行在哪些操作系统上？
 </a></li> 
<li><a href="#filesystem">所有它的一切是否是一种新的文件系统？比方说ext2文件系统？</a></li> 
<li><a href="#server-requirements">为了运行一个Subversion服务器，哪种硬件是我所需要的？</a></li>                                              
<li><a href="#apache-extension">我听说Subversion是Apache项目的扩展？我是否需要Apache来做服务器呢？</a></li> 
<li><a href="#need-apache">是否意味着我必须首先安装Apache才能使用Subversion？</a></li> 
<li><a href="#multiple-apachim">我现在所运行的是Apache 1.x，但是我不能仅仅为了支持Subversion版本库而将其转换成Apache 2.0。这是否意味着我不能使用Subversion服务器？</a></li>  
<li><a href="#feature-x">为什么不象SCM系统Y那样来做X？</a></li>
<li><a href="#globalrev">为什么全部的库都使用相同的版本号码？我想让我的每一个工程都有其自己的版本号码。</a></li>
<li><a href="#changesets">Subversion有没有变更集？</a></li>
<li><a href="#release">下一个版本什么时候发布？</a></li>
<li><a href="#symlinks">Subversion是否支持链接（symlinks）？</a></li>
<li><a href="#logo">我需要一个高分辨率的Subversion Logo，从哪里可以得到它呢？
</a></li>
<li><a href="#more-information">我还有些其他的问题，我从哪里可以得到更多的相关信息？</a></li>  
<li><a href="#moderation">为什么我的邮件没有显示在邮件列表上？</a></li>
</ul>

<h4>如何使用：</h4>
<ul>
<li><a href="#co-svn">怎么样检出Subversion版本库里的代码？</a></li>
<li><a href="#repository">怎么样创建一个版本库？怎样将数据导入到版本库中？</a></li> 
<li><a href="#cvs2svn">怎么样将已经存在于CVS版本库中的代码转换并导入到Subversion版本库中？</a></li>
    <li><a href="#proxy">我必须通过代理访问网络，我该怎么办？</a></li>
<li><a href="#paranoid">我的管理员不想让我有一个Subversion的HTTP服务器，那么如何做我才可以远程使用？</a></li> 
<li><a href="#multi-proj">如何在同一个版本库里管理几个不同的项目？</a></li>
<li><a href="#multi-merge">我如何合并两个完全分开的版本库？</a></li>
<li><a href="#nfs">我必须在NFS服务器上存储版本库/工作拷贝吗？</a></li>
<li><a href="#bdblogs">为何我的版本库占去这么多的磁盘空间？</a></li>
<li><a href="#reposperms">我如何恰当的设置我的版本库的权限呢？</a></li>
<li><a href="#readonly">为何只读的操作仍然需要版本库的写访问？</a></li>
<li><a href="#removal">如何完全的从版本历史库里面删除一个文件？</a></li>
<li><a href="#change-log-msg">一个版本提交之后，如何修改其日志信息？</a></li>
<li><a href="#patch">怎么样向版本库提交一个补丁？</a></li>
<li><a href="#in-place-import">我如何进行“iplace”的导入（例如：向Subversion添加一个目录结构，而原先的数据直接成为工作拷贝）？</a></li> 
<li><a href="#dumpload">人们在讨论升级Subversion时所说的“转储/加载（dump/load）”是什么？</a></li> 
<li><a href="#sspi">如何设置客户端通过使用SSPI认证的Windows域控制器进行认证？</a></li>
<li><a href="#adm-dir">我不喜欢“.svn”这样的目录名字，而喜欢“SVN”或者其他一些目录名，我该如何改变呢？</a></li>
<li><a href="#case-change">如何更改一个文件名的大小写？</a></li>
<li><a href="#merge-using-tags">我不能象CVS那样使用标签将一个分支的变更合并到主干（trunk），可以吗？</a></li>
<li><a href="#version-value-in-source">为什么$Revision$关键字不是我预想的那样？它替换的是文件最后修改的修订版本，但有时候我希望它能替换文件的当前修订版本。</a></li>
<li><a href="#log-in-source">Subversion是否有一个功能类似CVS的$Log$的关键字呢？</a></li>
<li><a href="#ignore-commit">在我的工程里有一个文件，每个人都必须改变它，但是我不希望他们本地的修改被提交，如何让'svn commit'忽略这个文件？</a></li>
<li><a href="#ssh-auth-cache">当我通过svn+ssh来访问一个版本库的时候，我的密码没有被缓存在~/.subversion/auth/，我应该如何避免每次都要键入密码？</a></li>
<li><a href="#ssh-svnserve-location">我的<tt>svnserve</tt>二进制程序不在我的用户的默认<tt>路径</tt>中，他们使用svn+ssh，我不知道怎样修改他们的路径来让他们运行<tt>svnserve</tt>。</a></li>
<li><a href="#ssh-authorized-keys-trick">
我希望允许通过svn+ssh://来访问版本库，但我很忧虑。我讨厌为每个用户分配一个登录帐号的方法，那样我会为他们是否被允许访问我的机器感到担心。</a></li>
<li><a href="#auto-props">我怎么才能为版本库的所有文件设置一个的属性？另外，我该如何确保每个添加到版本库里的新文件都有这些属性？</a></li>
<li><a href="#svn-editor">我如何处理编辑器路径中的空白？另外，如何定义编辑器的命令行选项？</a></li>
<li><a href="#divining-bdb-version">如何确定版本库正在使用的Berkeley DB的版本？</a></li>
<li><a href="#website-auto-update">我在版本库中管理了一个网站，如何才能实现每次提交之后站点自动更新？</a></li>
<li><a href="#single-file-checkout">我如何检出一个单独的文件？</a></li>
<li><a href="#wc-change-detection">如何在一切发生了之后检测工作拷贝中所做的添加、删除、拷贝和重命名操作？</a></li>
<li><a href="#svnserve-win-service">在Windows上如何将svnserve当作服务来运行？</a></li>
<li><a href="#bdb-fsfs-convert">如何转换我的版本库，从BDB到FSFS，或者从FSFS到BDB？</a></li>
<li><a href="#binary-files">版本库如何处理二进制文件？</a></li>
<li><a href="#terse-diff">如何让<tt>svn diff</tt>仅显示被改变的文件的名字，而不是连内容也显示出来？</a></li>
<li>
  <a href="#sorry-no-globbing">我能否用通配符或者点符号来一次性移动多个文件？</a>
</li>
<li><a href="#vendor-branch">我如何用Subversion维护一个第三方不断修正的软件呢？("供方分支")？</a></li>
</ul>

<h4>疑难解答：</h4>
<ul>
<li><a href="#stuck-bdb-repos">我的版本库经常看起来卡住了，一直报一个需要重新恢复(DB_RUNRECOVERY)的错误，怎么会导致这个问题？
    </a></li>
<li><a href="#bdb-recovery">每次我想访问我的版本库，进程就会挂起。我的版本库坏掉了吗？</a></li>
<li><a href="#bdb-cannot-allocate-memory">我的版本库一直报告错误"Cannot allocate memory"，我该怎么办？</a></li>
<li><a href="#wedged-wc">每当我试图运行一个svn命令时，都会提示我的工作拷贝已经被锁定了，是我的工作拷贝坏掉了吗？</a></li>
<li><a href="#wc-out-of-date">我试图去提交，但是Subversion提示我的工作拷贝已经过时。</a></li>
<li><a href="#obstructed-add">我为项目贡献了一个补丁，而这个补丁添加了一个新文件，现在<tt>svn update</tt>不能工作了。</a></li>
<li><a href="#unrecognized-url-error">我刚刚编译了分发二进制程序，但是当我试图检出版本库时，我得到一个错误“Unrecognized URL scheme”。这是怎么回事呢？</a></li>
<li><a href="#db-recover">当我查找或打开一个版本库时出现错误，但是我知道我版本库URL是正确的，哪里出错了？</a></li> 
<li><a href="#configure-sed-error">当我运行`<tt>configure</tt>'命令时，出现一些错误<tt>subs-1.sed&nbsp;line&nbsp;38:&nbsp;Unterminated&nbsp;`s'&nbsp;command</tt>，这是怎么回事？</a></li>
<li><a href="#windows-msvc-build">我在Windows下用MSVC++6.0构建Subversion时候有些麻烦，我该怎么办？</a></li>
<li><a href="#windows-drive-letter">如何在file:协议的URL中指定Windows盘符？<tt>file:</tt> URL?</a></li>
<li><a href="#write-over-dav">我在通过网络对Subersion版本库进行写操作的时候有些麻烦。</a></li>
<li><a href="#vs-asp-net">VS.NET/ASP.NET在处理".svn"目录名时好像有些问题，我该怎么办？</a></li>
<li><a href="#windows-xp-server">在Windows XP下，Subversion服务器有时候会发布一些错误数据，真的是这样吗？</a></li>  
<li><a href="#net-trace">在Subversion服务器和客户端之间进行交互时，跟踪网络的最好方法是什么？</a></li>
<li><a href="#revert">为什么<tt>svn revert</tt>要求有一个明确的目标？为什么它默认不是递归执行的呢？这与所有其他的子命令都不同。</a></li>
<li><a href="#db3db4">当我启动Apache时，mod_dav_svn报告"bad database version"，它发现的是db-3.X，而不是db-4.X。</a></li>
<li><a href="#redhat-db">在Red Hat 9 上，我得到一个"Function not implemented"错误，一切都停止工作。我该如何修正它呢？</a></li>
<li><a href="#no-author">为什么在文件在通过Apache（ra_dav）被提交和导入时，SVN的日志说"(no author)"？</a></li>
<li><a href="#windows-access-denied">我在Windows平台上偶尔会得到一个"Access Denied"错误，它的发生好像没有什么规律，为什么呢？</a></li>
<li><a href="#freebsd-hang">在FreeBSD上，某些操作(尤其是svnadmin create)有时候会被挂起。为什么？</a></li>
<li><a href="#http-301-error">我可以从一个WEB浏览器上查看我的版本库，但是在执行'svn checkout' 时发生一个错误："301 Moved Permanently"。那个地方出错了？</a></li>
<li><a href="#no-copy-history">我想查看一些我的文件的旧的版本，但是SVN有时候会说"path not found"，该怎么办呢？</a></li> 
<li><a href="#digest-auth">为什么HTTP的Digest认证不能工作？</a></li>
<li><a href="#xlc-compile">在AIX上通过xlc编译文件，出现了一些编译错误？怎么回事呢？</a></li>
<li><a href="#nonrecursive-checkout">我用非递归方式（通过-N选项）检出了一个目录，现在我想让某个子目录“出现”，但是<tt>svn up subdir</tt>不起作用。</a></li>
<li><a href="#mod_dav_svn-win32">我试图在Win32平台Apache服务器上使用mod_dav_svn，但是我得到找不到module的错误，而mod_dav_svn.so文件确实处在<tt>\Apache\modules</tt>下。</a></li>
<li><a href="#hook-debugging">为什么我的版本库钩子不工作？</a></li>
<li><a href="#diff-cmd">为什么我的--diff-cmd会有关于‘-u’的报错，我想用--extensions去覆盖它，但是不起作用。</a></li>
<li><a href="#plaintext-passwords">啊！我发现我的Subversion客户端在磁盘上以纯文本的形式缓存了密码！啊！</a></li>
<li><a href="#bdb41-tabletype-bug">我得到一个错误"svn: bdb: call
    implies an access method which is inconsistent with previous
    calls"。我该如何修正它呢？</a></li>
<li><a href="#hotcopy-large-repos">我无法热备份我的版本库，当文件大于2Gb时svnadmin会出错。</a></li>
<li><a href="#hidden-log">我看不到我刚刚提交的文件的日志记录，为什么呢？</a></li>
<li><a href="#bdb43-upgrade">升级到Berkeley DB 4.3或更新的版本之后，版本库出错了。</a></li>
<li><a href="#tiger-apr-0.9.6">当我通过http://从MacOS X 10.4 (Tiger)的平台上检出版本库的时候，为什么偶尔会得到一些不一致的错误？</a></li>
<li><a href="#debian-libtool">我不能构建Subversion，我的工作拷贝源码在Debian GNU/Linux上，在链接阶段我得到了一些错误，哪里错了呢？</a></li>
<li><a href="#freebsd-listen-host">我在使用FreeBSD，并且已经启动了svnserve，但是看起来并没有监听3690端口。</a></li>
<li><a href="#already-under-version-control">我不能添加一个目录，因为Subversion说“它已经处于版本控制了”。</a></li>
<li><a href="#slow-private-svnserve">有时候通过svnserve访问一个非公开的版本库实在是太慢了。</a></li>
<li><a href="#ssl-negotiation-error">当执行的Subversion操作需要通过SSL传递大量数据的时候，碰到一个错误<tt>SSL negotiation failed: SSL error: decryption failed or bad
    record mac</tt>。</a></li>
<li><a href="#broken-subclipse">我得到一个错误"This client is too
    old"。</a></li>
<li><a href="#switch-problems">为什么有时候<tt>svn switch</tt>不能工作？</a></li>
<li><a href="#long-paths">在Windows平台上，通过命令行客户端的执行更新操作时，我碰到一个错误"The
    system cannot find the path specified"，并且提示说我的工作拷贝可能损坏了，但是我能通过TortoiseSVN更新时完全正常，这是怎么回事呢？
    </a></li>
<li><a href="#working-copy-format-change">我碰到一个错误"This
    client is too old to work with working copy '...' "，不升级Subversion能够解决吗？</a></li>
<li><a href="#relocation-against-local-symbol">当我在64位Linux上编译Neon库时，发生一个错误"relocation R_X86_64_32 against `a local symbol' can not be used
    when making a shared object"。</a></li>
</ul>

<h4>开发者问题</h4>
<ul>
<li><a href="#ramdisk-tests">怎样在RAM磁盘上进行回归测试？</a></li>
<li><a href="#dynamic-exe-debugging">怎样在不安装的情况下对动态Subversion库运行调试器？</a></li>
<li><a href="#avoiding-compiler-inlining">怎样让编译器不内联混淆（inlining obfuscating）源代码的情况下对Subversion库运行调试器？</a></li>
</ul>

<h4>说明:</h4>
<ul>
<li><a href="#http-methods">Subversion用到的HTTP方法是有哪些？ 
    </a></li>
<li><a href="#bikeshed">什么是'bikeshed'？</a></li> 
<li><a href="#pronounce">你是怎样读"Subversion"的？</a></li> 
<li><a href="#baton">什么是'baton'？</a></li> 
<li><a href="#def-wedged-repository">当你说版本库是'楔住（wedged）'的时候，是什么意思？</a></li>
</ul>

</div>


<hr/>

<div class="h2" id="general-questions" title="general-questions">
<h2>常见问题：</h2>


<div class="h3" id="why" title="why">
<h3>为什么会有这样一个项目？</h3>

<p>为了接管CVS用户的基地.确切的说,我们写了一个新的版本控制系统，它和CVS很相似，但是它修正了以前CVS所没有解决的许多问题。请参见第一页.</p>

</div>


<div class="h3" id="collab" title="collab">
<h3>Subversion是专有软件的吗?我听说它是属于CollabNet公司的。</h3>

<p>不是，Subversion一款开源/免费的软件。CollabNet公司为几个全职的开发人员支付薪水，并且拥有相关代码的版权，但是这个版权是<a
href="http://subversion.tigris.org/license-1.html">一个
Apache/BSD-风格的许可证明</a>
它完全遵从于<a
href="http://www.debian.org/social_contract#guidelines">Debian Free
Software Guidelines</a>. 换句话说，你可以随心所欲的去下载，修改，或者重新发布新的版本，而不需要经过CollabNet公司或者其他任何一个人的许可。</p>

</div>


<div class="h3" id="stable" title="stable">
<h3>Subversion用在我的项目上是否足够稳定？</h3>

<p>是的,绝对是这样的. 它已经完全为一些复杂的(prime-time)软件产品做好了准备.</p>

<p>Subversion从2000年开始开发，在一年之后成为一个自足执行(self-hosting)的项目.当我们将其称为"alpha"版本的时候,
Subversion已经被很多的个人开发人员所使用，并且
shops for real work.在那之后，有两年多的时间被用来进行Bug追踪(bugfixing)和增强稳定性(stabilization)，直到我们发布了
1.0版本.大多数的其它项目可能都会把产品的“1.0”版本叫做早期版本，但是我们故意的尽可能长的推迟了这个版本的发布。我们意识到很多人在他们最初使用了Subversion之后一直在等待1.0版本的发布，并且对这个意义非凡的版本有着特别的期待。所以我们在这样一个版本上用了很多的时间而不至于让他们失望。</p>

</div>



<div class="h3" id="interop" title="interop">
<h3>Subversion的客户端/服务器协同工作的策略是怎样的？</h3>

<p>客户端和服务器被设计成只要他们相互之间没有超过一个主要的发行版本，就可以协调工作。例如任何一个1.x的客户端都可以和一个1.y的服务器协调工作。然而，如果客户端和服务器的版本不相匹配，某些特性可能不能使用。</p>

<p>客户端和服务器之间的兼容性策略记录在<a href="hacking.html">Hacker's Guide
to Subversion</a>的“兼容性”一节里面.</p>

</div>


<div class="h3" id="portability" title="portability">
<h3>Subversion可以运行在哪些操作系统上？</h3>

<p>所有现代风格的操作系统，比如Unix, Win32, BeOS, OS/2, MacOS X.</p>

<p>Subversion是用ANSI C来写的，并且使用了APR,<a
href="http://apr.apache.org">Apache Portable Runtime</a>库,作为一个轻量的层。Subversion的客户端将可以运行在任何APR运行的地方，这是最主要的地方。这和Subversion服务器(例如, the repository
side)是相同的,除非是在Berkeley DB的Win9x(Win95/Win98/WinME)作为平台的主机上,因为Berkeley DB在Win9x平台上共享存储器片段问题。FSFS版本库(才版本1.1中有介绍)没有这种限制；然而由于Win9x对文件锁定的支持限制，他们仍然不能在Win9x的平台上工作。</p>

<p>重申一下，Subversion客户端可以运行在任何APR所运行的平台.Subversion服务器也可以运行在任何APR平台所能运行的平台，但是不能让Win95/Win98/WinMe作为平台的主机</p>

</div>


<div class="h3" id="filesystem" title="filesystem">
<h3>所有它的一切是否是一种新的文件系统？比方说ext2文件系统？</h3>

<p>不是。"Subversion文件系统"不是一个可以装在操作系统上的内核级的文件系统，相反，它是Subversion版本库的接口，是一个版本文件系统，在某种意义上说，它可以存储一个文件目录结构（树）并且使这个目录结构从一个修订版本到下一个修订版本的过程中保留版本信息。访问这个版本库来编写程序和使用其他文件系统的API是很相似的，但是最大的不同在于，这个特殊的文件系统在你写入的时候不会丢失数据。目录结构(树)的一些旧的状态信息可以被很容易的恢复，就像恢复到最近的状态那样容易。</p>

</div>


<div class="h3" id="server-requirements" title="server-requirements">          
<h3>为了运行一个Subversion服务器，哪种硬件是我所需要的？</h3>           
                                                                               
<p>运行Subversion服务器要依赖各方面的多种因素，比如说一定数量的用户，经常性的提交，其它相关联的服务器，版本库的大小以及自定义版本库的负载等。当使用Apache时，有可能Apache本身在内存的使用情况将成为最大的制约因素。请参阅邮件列表上对这个问题的
<a href="http://subversion.tigris.org/servlets/BrowseList?list=users&amp;by=thread&amp;from=330941"
>讨论</a>，这里有针对这个问题的明确的答案。</p>

<p>需要记住的说是，在同一台服务器上运行其它的应用程序，比如版本库的浏览器同样会使用内存，它是独立于Subversion 本身。</p>

<p>通常，和CVS本版库相比，你可以期望需要更少的服务器内存。</p>

</div>


<div class="h3" id="apache-extension" title="apache-extension">
<h3>我听说Subversion是Apache项目的扩展？我是否需要Apache来做服务器呢？</h3>

<p>不用.  Subversion是一系列的库。它与一个命令行的客户端相互配合工作。有两类不同的Subversion的服务器进程，包括一个<b>svnserve</b>进程,这是一个小的标准独立（standalone?）程序，和CVS的pserver进程相似。另一个是Apache <b>httpd-2.0</b>使用了一种特殊的
 <b>mod_dav_svn</b>单元。 <b>svnserve</b>进程可以说是一个常用协议，而<b>mod_dav_svn</b>进程使用了WebDAV作为它的网络协议。请参阅Subversion手册<a
href="http://svnbook.red-bean.com/html-chunk/ch06.html">第六章</a>
以了解更多的内容。</p>

</div>



<div class="h3" id="need-apache" title="need-apache">
<h3>是否意味着我必须首先安装Apache才能使用Subversion？</h3>

<p>简而言之：不必。</p>

<p>详细的回答是：如果你仅仅是想曲访问一个版本库，你仅仅需要构建一个Subversion的客户端。如果你想拥有一个网络的版本库，那么你需要安装Apache2或者一个“svnserve”服务器。</p>

<p>关于安装一个可以访问的Subversion服务器的详细信息，请参阅：Subversion手册 <a
href="http://svnbook.red-bean.com/html-chunk/ch06.html">第六章</a>
</p>

</div>



<div class="h3" id="multiple-apachim" title="multiple-apachim">
<h3>我现在所运行的是Apache 1.x，但是我不能仅仅为了支持Subversion版本库而将其转换成Apache 2.0。这是否意味着我不能使用Subversion服务器？</h3>

<p>不毕，你可以用<b>svnserve</b>作为Subversion的服务器。它可以很好的工作。</p>

<p>在使用Apache server时，如果你想使用分布式创作和版本管理协议（WebDAV）和所有其他一些好的功能特性，那么是的，你需要Apache 2.0。但是不管怎样，当你继续在80端口运行Apache1.0的时候，你总是可以在另外一个不同的端口运行Apache2.0。不同版本的Apache可以在同一台机器上很好的和平相处。仅仅需要在改变httpd.conf文件中把<tt>Listen</tt>指令从80改成8080，或者其他你想要改成的端口。然后确保在你公布版本库的URL的时候加以说明：
(例如，<tt>http://svn.mydomain.com:8080/repos/blah/trunk/</tt>)。</p>

</div>


<div class="h3" id="feature-x" title="feature-x">
<h3>为什么不象SCM系统Y那样来做X？</h3>

<p>我们从来没有试图在SCM系统上推到重来，开辟出一个新的天地，也没有试图完全模仿每一个SCM系统的好的特性。我们只是要取代CVS。请参阅我们的第一个问题。</p>

</div>


<div class="h3" id="globalrev" title="globalrev">
<h3>为什么全部的库都使用相同的版本号码？我想让我的每一个工程都有其自己的版本号码。</h3>
<p>
一般来说从用户角度来看，在版本库上使用全局的版本号码是没有什么太大意义的。这是为了实现一些潜在的设计目标的内部机制。它和自然的被暴露出来，使得用户接口有时候看起来和不得不使用一些长的令人讨厌的时间日期的字符串一样，有些不方便。
</p>

<p>版本号码是唯一和版本库以及用户易用性相关的。它对你所在版本库中存储的东西 <b>没有</b>任何其他方面的影响。
版本库版本号码的冲突对于精确标识代码实际变化速率几乎没有什么用处。还有更多其他复杂的方式可以更好的来描绘代码的变化速率。
</p>

</div>


<div class="h3" id="changesets" title="changesets">
<h3>Subversion是否有一个变更集?</h3>

<p>这个问题有些麻烦，因为好像每个人对变更集的定义多少有些不同，或者至少对版本控制系统的变更集特性多少有些不同的期望。</p>

<p>基于这个讨论的目的，这里对变更集有一个简单的定义：它是所有改变的唯一的名字的集合，这些改变可能包括对文件内容句法的编辑，目录结构的改变，或者是一些元数据的重新组合。更加通常的理解，一个结果集仅仅是一个你所能进行参阅的补丁的名字。 </p>

<p>Subversion按照事务的最初的次序来管理版本目录树(版本库是一组目录树), 而这些变更集便是从次得来（通过和最近的目录树相比较）。系统像是拱形的门或者
Bitkeeper被从相反的方向来进行构建：他们被设计用以对象最初的次序来管理变更集  (版本库是一系列的补丁), 并且这个目录树是由一系列的补丁组成的。</p>

<p>从根本上来说，两者都不够好： 争论至少可以追溯到三十年以前。两种设计方式或好或坏都是对两种不同类型的软件开发而言。现在我们不打算讨论这些，然而这里我将说明你能用Subversion来做什么。</p>

<p>用Subversion，用一个全局的版本编号N来命名版本库目录树：这是说版本库是经过第N次提交。它还包括一些不明显的变更集：如果你比较目录树N和目录树N-1，你将得到提交时的详细信息。
</p>

<p>因此，可以很容易的想到，版本N不仅仅是一个变更集。如果你用一个事件追踪去管理bug，你可以用版本号码去引用特殊的补丁，这些补丁很适合bug。例如，”这个事件被稳定在9238版本。“一些人可能运行‘svn log -r9238’来阅读对应Bug的补丁信息，运行‘svn diff -r9237:9238’来查看补丁本身的信息。Svn的合并命令也是利用了版本号码。你可以把一个分支明确的合并到另一个分支的结果集，通过命名它们。合并参数：‘svn merge -r9237:9238 branchURL’将合并结果集＃9238到你的工作拷贝。</p>

<p>这对于一个以构建结构集为主要目标来的系统来说，绝对不是很复杂的，但是它已经比CVS方便许多了。</p>

</div>


<div class="h3" id="release" title="release">
<h3>下一个版本什么时候发布？</h3>

<p>See our status page, <a
href="http://subversion.tigris.org/project_status.html">
http://subversion.tigris.org/project_status.html</a>.</p>

</div>


<div class="h3" id="symlinks" title="symlinks">
<h3>Subversion是否支持symlinks?</h3>

<p>Subversion 1.1 (和后续版本)已经可以把一个symlink置于版本控制之中，通过一个常用的<tt>svn add</tt>命令</p>

<p>详细说起来：版本库还没有一个关于symlink的内部概念。它存储一个"versioned symlink"作为一个普通文件的加上一个'svn:special'属性。svn客户端(在unix上)可以看到属性和并且在工作空间里转换成一个symlink。Win32没有symlinks，所以一个win32的客户端不会做任何的转换：对象表象的像一个平常的文件。</p>

</div>


<div class="h3" id="logo" title="logo">
<h3>我需要一个高分辨率的Subversion Logo,从哪里可以得到它呢？</h3>

<p>可用的矢量Subversion logo在 <a href="http://svn.collab.net/repos/svn/trunk">Subversion
版本库</a>的<a
href="http://svn.collab.net/repos/svn/trunk/www">www文件夹</a>下可以得到。</p>

<p>特别的是，<a
href="http://svn.collab.net/repos/svn/trunk/www/logo/subversion_logo.eps">EPS
版本</a>,和一个<a
href="http://svn.collab.net/repos/svn/trunk/www/logo/subversion_logo.ai">Adobe
插图文档</a>也是可用的。</p>

</div>


<div class="h3" id="more-information" title="more-information">
<h3>我还有其他的一些问题，我从哪里可以得到更多的信息呢？</h3>

<p>如果你在阅读这个常见问题回答之后，没有找到你问题的答案，那么你还有其他的几个资源可以利用：</p>
<ul>
  <li><a href="http://svnbook.red-bean.com">Subversion手册</a></li>
  <li><a href="http://subversion.tigris.org/servlets/ProjectMailingListList">The
       Subversion用户邮件列表</a> (<a
       href="mailto:users@subversion.tigris.org"
       >users@subversion.tigris.org</a>)
       &mdash; note that the list is <a href="#moderation">moderated</a>, so
       there may be a delay before your post shows up</li>
  <li><a href="http://svn.haxx.se/users/">Subversion用户信息列表。</a></li>
  <li>在线聊天系统（IRC）在 #svn on irc.freenode.net频道上面。</li>
  <li><a href="http://www.svnforum.org/">svnforum.org</a>一个非官方基于网络的论坛，针对的读者和邮件列表近似。</li>
</ul>

</div>


<div class="h3" id="moderation" title="moderation">
<h3>为什么我的邮件没有显示在邮件列表上？</h3>

<p>我们的邮件列表为了保持在一个适度的标准，所以你最初的邮件可能会被推迟，知道维护人员有机会让它通过。一旦邮件允许通过，所有从相同的地址挂起的邮件将被自动支持，所以你应该不会再被拒绝。当然，如果你的发送地址改变了的话，你将不得不再次通过。</p>

</div>


</div>

<div class="h2" id="how-to" title="how-to">
<h2>How-to:</h2>
<p/>


<div class="h3" id="co-svn" title="co-svn">
<h3>我如何才能检出Subversion版本库里的代码？</h3>
<p>使用Subversion客户端：</p>
<pre>
	$ svn co http://svn.collab.net/repos/svn/trunk subversion
</pre>
<p>这将会从Subversion源文件目录里检出一个名叫subersion的目录到你的本机上。 </p>

</div>


<div class="h3" id="repository" title="repository">
<h3>我如何创建一个版本库呢？并且我又该如何向里导入数据呢？</h3>

<p>请参阅<a
href="http://svn.collab.net/repos/svn/trunk/README">
http://svn.collab.net/repos/svn/trunk/README</a>;  specifically,在IV部分，即 "Quickstart Guide".</p>

<p>更详细的资料，请阅读<a
 href="http://svnbook.red-bean.com">Subversion手册</a>第五章。</p>

</div>



<div class="h3" id="cvs2svn" title="cvs2svn">
<h3>我如何把一个现存的CVS版本库转换成Subversion版本库？</h3>

<p>试一下cvs2svn转换工具，从<a
href="http://cvs2svn.tigris.org/">http://cvs2svn.tigris.org/</a> (或者从这里 <a href="http://cvs2svn.tigris.org/features.html" >特性列表</a>和<a href="http://cvs2svn.tigris.org/cvs2svn.html"
>相关文档</a>).  cvs2svn是大多数人的选择，但是如果有别的原因使他不能满足你的要求，至少还有其他两种工具供你选择：</p>

<ul>

<li>一个是基于 <a
href="http://public.perforce.com/public/revml/index.html">VCP</a>
这是由Chia-liang Kao写的，可以在<a
href="http://search.cpan.org/perldoc?VCP::Dest::svk">CPAN</a>找到.</li>

<li>另一个由Lev Serebryakov写的refinecvs，在 <a
href="http://lev.serebryakov.spb.ru/refinecvs/"
>http://lev.serebryakov.spb.ru/refinecvs/</a>上面可以找到。</li>

</ul>

<p>也可以参阅<a href="links.html">Subversion链接</a>页面。</p>

</div>



<div class="h3" id="proxy" title="proxy">
<h3>我必须通过代理访问网络,我该怎么办?</h3>

<p>Subversion支持通过代理访问网络.首先,修改配置文件中的"servers"部分,
并指定你的代理服务器.配置文件所在目录在不同的操作系统上可能不同.在Linux或
Unix系统中,通常是~/.subversion.在Windows系统中,通常是"%APPDATA%\Subversion".
(执行"echo %APPDATA%"显示目录的具体路径, 注意这是一个隐藏目录.)</p>

<p>配置文件中的注释描述了配置文件书写的格式.如果配置文件还不存在,取得最新版的svn,
并执行任何svn命令,这将创建配置文件模板及其相应的目录.</p>

<p>其次,请确认你的代理服务器支持所有Subversion必须的HTTP方法.有些代理
服务器默认不支持以下发放: PROPFIND, REPORT, MERGE, MKACTIVITY,
CHECKOUT.解决本法依赖于你使用的代理服务器软件.对于Squid, 配置选项如下</p>

<pre>
   #  TAG: extension_methods
   #       Squid only knows about standardized HTTP request methods.
   #       You can add up to 20 additional "extension" methods here.
   #
   #Default:
   # none
   extension_methods REPORT MERGE MKACTIVITY CHECKOUT
</pre>

<p>(Squid 2.4及其之后的版本支持PROPFIND.)</p>

<p>参见"<a href="#http-methods">Subversion必须的HTTP方法是哪些??</a>"来配置
代理服务器来支持HTTP方法.</p>

<p>如果让代理服务器支持Subversion访问网络很困难甚至是不可能的话,而你只想checkout
 Subversion的源代码,你可以绕过代理服务器.一些代理服务器封锁了80端口,如果是这样
的话,可以通过81端口访问<tt>svn.collab.net</tt>代码库服务器.执行:</p>

<pre>
   svn checkout http://svn.collab.net:81/repos/svn/trunk subversion
</pre>

<p>可能代理服务器会放行.另一个办法是通过SSL来checkout,SSL被大部分代理服务器所支持:</p>

<pre>
   svn checkout https://svn.collab.net/repos/svn/trunk subversion
</pre>

<p>当然,你的svn客户端应该支持ssl.在编译源代码的时候,在<tt>./configure</tt>时添加
<tt>--with-ssl</tt>选项.执行<tt>svn --version</tt>可以知道你的
svn是否支持'https'.</p>

</div>


<div class="h3" id="paranoid" title="paranoid">
<h3>我的管理员不想让我有一个Subversion的HTTP服务器，那么如何做我才可以远程使用？</h3>

<p>一个简单的选择是使用<b>svnserve</b>服务器来代替。请参阅SVN手册<a
href="http://svnbook.red-bean.com/html-chunk/ch06.html">第6章</a>中的详细内容。
</p>

<p>然而，如果你的管理员不希望你运行Apache，这很可能是他们不想让你在3690端口运行一个客户服务器。所以另外假定的备选答案是你的管理员如果同意你使用现有的SSH设施。</p>

<p>如果你使用CVS，你可能已经使用SSH来登录CVS服务器，  The ra_svn Subversion的访问方法是和使用Subversion是相同的。仅仅是在你的版本库的URL上加上一个"svn+ssh"的前缀。</p>
<pre>
$ svn checkout svn+ssh://your.domain.com/full/path/to/repository
</pre>

<p>这将使你的SSH的程序运行一个私有的'svnserve'进程 process on
the remote box, which accesses the repository as your UID and tunnels
the information back over the encrypted link.</p>

<p>然而，另外的一种解决方案是可以被用来代替can be used instead is to leverage
SSH port forwarding to connect to the protected server via ra_dav.
You would connect via SSH to a machine behind your firewall that can
access your Subversion server.  Note that this SSH server does
<b>not</b> have to be the same as where Subversion is installed.  It
can be, but it doesn't have to be.</p>

<p>然后你可以创建一个本地端口来连接在你家里的Subversion版本库的HTTP服务器。你可以通过本地端口’连接‘Subversion版本库。然后，请求将被通过SSH服务器’通道‘发送到你的Subversion服务器。</p>

<p>一个示例：一个Subversion ra_dav setup is behind your company firewall
at 10.1.1.50 (call it svn-server.example.com).  Your company allows SSH
access via publicly accessible ssh-server.example.com. Internally, you
can access the Subversion repository via
http://svn-server.example.com/repos/ours.</p>

<p><i>实例</i>：通过port-forwarding客户端连接ssh服务器和通过port forward检出。</p>

<pre>
% ssh -L 8888:svn-server.example.com:80 me@ssh-server.example.com
% svn checkout http://localhost:8888/repos/ours
</pre>

<p>Note that your svn-server.example.com could also have its httpd
instance running on an unprivileged port by a non-trusted user.  This
will allow your Subversion server not to require root access.</p>

<!-- Can you use svn switch to switch your WC between your internal and
     external Subversion server?  I think so.  -->

<p>Joe Orton notes</p>
<pre>
服务器对正在使用的MOVE和COPY请求头的主机名字是很敏感的，所以这个地方你必须要小心－一个"ServerAlias localhost"可能被要求合适的工作方式才行。
</pre>

<p>Some links on SSH port forwarding</p>

<ul>
<li><a href="http://www.onlamp.com/pub/a/onlamp/excerpt/ssh_11/index3.html"
>http://www.onlamp.com/pub/a/onlamp/excerpt/ssh_11/index3.html</a></li>
<li><a href="http://csociety.ecn.purdue.edu/~sigos/projects/ssh/forwarding/"
>http://csociety.ecn.purdue.edu/~sigos/projects/ssh/forwarding/</a></li>
<li><a href="http://www.zip.com.au/~roca/ttssh.html">TTSSH: A Win32 SSH client capable of port forwarding</a></li>
</ul>

</div>


<div class="h3" id="multi-proj" title="multi-proj">
<h3>我如何在Subversion下面管理几个不同的工程?</h3>

<p>这决定与你的工程的复杂度，如果你的工程是相关的，并且有可能要共享数据，那么最好的方式是通过子目录创建一个版本库。像下面这样子：</p>
<pre>
	$ svnadmin create /repo/svn
	$ svn mkdir file:///repo/svn/projA
	$ svn mkdir file:///repo/svn/projB
	$ svn mkdir file:///repo/svn/projC
</pre>

<p>如果你的工程是完全不相关的，并且他们之间不可能共享数据，这样最好创建几个独立的完全不相关的版本库。</p>
<pre>
	$ mkdir /repo/svn
	$ svnadmin create /repo/svn/projA
	$ svnadmin create /repo/svn/projB
	$ svnadmin create /repo/svn/projC
</pre>
<p>
这两种方式之间不同之处在于： (由
Ben Collins-Sussman解释 &lt;sussman@collab.net&gt;):</p>

<ul>
  <li>
     在第一种情况之下，代码可以很容易的在两个项目之间拷贝和移动，并且操作的历史记录会被保存下来。  
	 ('svn cp/mv' currently only works within a single repository.)
  </li>
  <li>
     因为版本号是版本库的标识，在第一种情况下，对任何工程的提交都可能造成全局的版本冲突。所以这看起来有些奇怪，如果有个人已经检出了’projB‘，注意已经发生的十次修订，但是projB并没有完全改变。
	 事实上，这不是最重要的，仅仅是有些奇怪。这种情况在人们每次向rapidsvn提交的时候常常发生，
     当rapidsvn在同一个版本库之下时。:-)
  </li>
  <li>
     第二种情况可能是更安全的，这更容易使用Apache访问控制每个项目之间隔绝（就用户和许可的角度来讲）
     在后一种情况下，你将需要一个 
     fancy hook script在版本库中区别工程。
     ("这允许用户提交特殊的子目录吗？")当然，我们已经准备了这些script让你使用。
  </li>
</ul>

</div>

  
<div class="h3" id="multi-merge" title="multi-merge">
<h3>我如何合并两个完全分开的版本库？</h3>

<p>If you don't care about retaining all the history of one of the
repositories, you can just create a new directory under one project's
repository, then import the other.</p>

<p>If you care about retaining the history of both, then you can use
'svnadmin dump' to dump one repository, and 'svnadmin load' to load it into
the other repository.  The revision numbers will be off, but you'll
still have the history.</p>

<p>Peter Davis &lt;peter@pdavis.cx&gt; also explains a method using svn's
equivalent to CVS modules:</p>

<blockquote>
	<p>As long as the merging takes place in separate directory
	trees, you can use svn's version of CVS modules.</p>

	<p>Set the <em>svn:externals</em> property on a directory to checkout
	directories from other repositories whenever the original
	directory is checked out.  The repository remains separate,
	but in the working copy it appears that they have been merged.
	If you commit to the imported directory, it will affect the
	external repository.</p>

	<p>The merge isn't completely clean: the import only affects
	working copies, so you won't be able to use a URL in the first
	repository to access modules imported from the second.  They
	remain separate URLs.</p>
</blockquote>

<p>See also <a href="links.html#misc_utils">miscellaneous utilities</a>
for helpful tools to select and reorder revisions when merging
several repositories, especially the 
<a href="http://www.coelho.net/svn-merge-repos.html">svn-merge-repos.pl</a> 
perl script for basic operations and the
<a href="http://svn.borg.ch/svndumptool/">SvnDumpTool</a> python classes
for advanced reorganisations.</p>
</div>


  
<div class="h3" id="nfs" title="nfs">
<h3>Should I store my repository / working copy on a NFS
server?</h3>

<p>If you are using a repository with the Berkeley DB back end
(default for repositories created with Subversion 1.0 and 1.1, not the
default thereafter), we recommend <i>not</i> storing the repository on
a remote filesystem (for example, NFS).  While Berkeley DB databases
and log files can be stored on remote filesystems, the Berkeley DB
shared region files cannot be stored on a remote filesystem, so the
repository may be safely accessed by only a single filesystem client,
and not all Subversion functionality will be available to even that
one client.</p>

<p>If you are using the <a
href="http://svn.collab.net/repos/svn/trunk/notes/fsfs">FSFS</a>
repository back end, then storing the repository on a modern NFS
server (i.e., one that supports locking) should be fine.</p>

<p>Working copies can be stored on NFS (one common scenario is when
your home directory is on a NFS server).  On Linux NFS servers, due to
the volume of renames used internally in Subversion when checking out
files, some users have reported that 'subtree checking' should be
disabled (it's enabled by default).  Please see <a
href="http://nfs.sourceforge.net/nfs-howto/server.html" >NFS Howto
Server Guide</a> and <b>exports(5)</b> for more information on how to
disable subtree checking.</p>

<p>We've had at least one report of working copies getting wedged
after being accessed via SMB.  The server in question was running a
rather old version of Samba (2.2.7a).  The problem didn't recur with a
newer Samba (3.0.6).</p>

</div>

  
<div class="h3" id="bdblogs" title="bdblogs">
<h3>Why is my repository taking up so much disk space?</h3>

<p>The repository stores all your data in a Berkeley DB "environment"
in the repos/db/ subdirectory.  The environment contains a collection
of tables and bunch of logfiles (log.*).  Berkeley DB journals all
changes made to the tables, so that the tables can be recovered to a
consistent state in case of interruptions (<a
href="#bdb-recovery">more info</a>).</p>

<p>The logfiles will grow forever, eating up disk space, unless you,
(as the repository administrator) do something about it.  At any given
moment, Berkeley DB is only using a few logfiles actively (see <a
href="http://subversion.tigris.org/servlets/ReadMsg?list=users&amp;msgNo=15194"
>this post</a> and its associated thread); the rest can be safely
deleted.  If you keep all the logfiles around forever, then in theory
Berkeley DB can replay every change to your repository from the day it
was born.  But in practice, if you're making backups, it's probably
not worth the cost in disk space.</p>

<p>Use <code>svnadmin</code> to see
which log files can be deleted.  You may want a cron job to do this.</p>

<pre>
$ svnadmin list-unused-dblogs /repos
/repos/db/log.000003
/repos/db/log.000004
[...]

$ svnadmin list-unused-dblogs /repos | xargs rm
# disk space reclaimed!
</pre>

<p>You could instead use Berkeley DB's <code>db_archive</code> command:</p>

<pre>
$ db_archive -a -h /repos/db | xargs rm
# disk space reclaimed!
</pre>

<p>See also <code>svnadmin hotcopy</code> or <code>hotbackup.py</code>.</p>

<p><strong>Note:</strong> If you use Berkeley DB 4.2, Subversion will
create new repositories with automatic log file removal enabled. You
can change this by passing the <code>--bdb-log-keep</code> option to
<code>svnadmin create</code>. Refer to the section about the <a
href="http://www.oracle.com/technology/documentation/berkeley-db/db/api_c/env_set_flags.html#DB_LOG_AUTOREMOVE">
<code>DB_LOG_AUTOREMOVE</code></a> flag in the Berkeley DB manual.</p>

</div>


<div class="h3" id="reposperms" title="reposperms">
<h3>How do I set repository
permissions correctly?</h3>

<p>Try to have as <em>few</em> users access the repository as
possible.  For example, run apache or 'svnserve -d' as a specific
user, and make the repository wholly owned by that user.  Don't allow
any other users to access the repository via <tt>file:///</tt> urls,
and be sure to run 'svnlook' and 'svnadmin' only as the user which
owns the repository.</p>

<p>If your clients are accessing via <tt>file:///</tt> or
<tt>svn+ssh://</tt>, then there's no way to avoid access by multiple
users.  In that case, read <a
href="http://svnbook.red-bean.com/html-chunk/ch06s05.html">the last
section in chapter 6</a>, and pay particular attention to the
"checklist" sidebar at the bottom.  It outlines a number of steps to
make this scenario safer.</p>

<b>Note for SELinux / Fedora Core 3+ / Red Hat Enterprise users:</b>

<p>In addition to regular Unix permissions, under SELinux every file,
directory, process, etc. has a 'security context'.  When a process
attempts to access a file, besides checking the Unix permissions the
system also checks to see if the security context of the process is
compatible with the security context of the file.</p>

<p>Fedora Core 3, among other systems, comes with SELinux installed by
default, configured so that Apache runs in a fairly restricted
security context.  To run Subversion under Apache, you have to set the
security context of the repository to allow Apache access (or turn off
the restrictions on Apache, if you think all this is overkill).  The
<tt>chcon</tt> command is used to set the security context of files
(similarly to how the <tt>chmod</tt> sets the traditional Unix
permissions).  For example, one user had to issue this command</p>

<pre>   $ chcon -R -h -t httpd_sys_content_t <i>PATH_TO_REPOSITORY</i></pre>

<p>to set the security context to be able to successfully
access the repository.</p>

</div>



<div class="h3" id="readonly" title="readonly">
<h3>为什么只读操作仍然需要对版本库的写权限？</h3>

<p>Certain client operations are "read-only", like checkouts and
updates.  From an access-control standpoint, Apache treats them as
such.  But libsvn_fs (the repository filesystem API) still has to
write temporary data in order to produce tree-deltas.  So the process
accessing the repository always requires both read <em>and</em> write
access to the Berkeley DB files in order to function.</p>

<p>In particular, the repository responds to many "read-only"
operations by comparing two trees.  One tree is the usually the HEAD
revision, and the other is often a temporary transaction-tree -- thus
the need for write access.</p>

<p>This limitation only applies to the Berkeley DB backend; the <a
href="http://svnbook.red-bean.com/svnbook-1.1/ch05.html#svn-ch-5-sect-1.2.A">FSFS
backend</a> does not exhibit this behaviour.</p>

</div>


<div class="h3" id="removal" title="removal">
<h3>
我如何完全的从版本库的历史历史记录里删除一个文件？
</h3>

<p>有几种特殊的情况你可能希望完全的删除你曾经提交过的文件的所有信息，（或许有人意外的提交了一份保密的文档）。但是这个操作不是很容易完成，因为Subversion是被有意设计成决不丢失信息。修订版本是基于上一个版本所构建的不可改变（immutable）的文件树。从版本的历史记录里删除一个修订版本将会造成多米诺骨牌效应，造成后继版本的混乱，还有可能使得所有的工作拷贝无效</p>

<p>The project has plans, however, to someday implement an <b>svnadmin
obliterate</b> command which would accomplish the task of permanently
deleting information. (See <a
href="http://subversion.tigris.org/issues/show_bug.cgi?id=516">issue
516</a>.)</p>

<p>现在，你只有求助于你版本库的<b>svnadmin dump</b> ， then pipe the dumpfile through <b>svndumpfilter</b>（？？？？？？？有点乱？？）
(excluding the bad path) into an <b>svnadmin load</b>命令 请参阅Subversion手册<a
href="http://svnbook.red-bean.com/html-chunk/ch05.html">第五章</a>的相关详细信息。
</p>

</div>


<div class="h3" id="change-log-msg" title="change-log-msg">
<h3>
How do I change the log message for a revision after it's been committed?
</h3>

<p>Log messages are kept in the repository as properties attached to each
revision.  By default, the log message property (<em>svn:log</em>) cannot be
edited once it is committed.  That is because changes to <a
href="http://svnbook.red-bean.com/svnbook/ch05.html#svn-ch-5-sect-1.2">revision
properties</a> (of which <em>svn:log</em> is one) cause the property's
previous value to be permanently discarded, and Subversion tries to prevent
you from doing this accidentally.  However, there are a couple of ways to get
Subversion to change a revision property.</p>

<p>The first way is for the repository administrator to enable revision
property modifications.  This is done by creating a hook called
"pre-revprop-change" (see <a
href="http://svnbook.red-bean.com/svnbook/ch05s02.html#svn-ch-5-sect-2.1">this
section</a> in the Subversion book for more details about how to do this).
The "pre-revprop-change" hook has access to the old log message before it is
changed, so it can preserve it in some way (for example, by sending an email).
Once revision property modifications are enabled, you can change a revision's
log message by passing the --revprop switch to <b>svn propedit</b> or <b>svn
propset</b>, like either one of these:</p>

<pre>
$ svn propedit -r N --revprop svn:log URL
$ svn propset -r N --revprop svn:log "new log message" URL
</pre>

<p>where N is the revision number whose log message you wish to change, and
URL is the location of the repository.  If you run this command from within a
working copy, you can leave off the URL.</p>

<p>The second way of changing a log message is to use <b>svnadmin setlog</b>.
This must be done by referring to the repository's location on the filesystem.
You cannot modify a remote repository using this command.</p>

<pre>
$ svnadmin setlog REPOS_PATH -r N FILE
</pre>

<p>where REPOS_PATH is the repository location, N is the revision number whose
log message you wish to change, and FILE is a file containing the new log
message.  If the "pre-revprop-change" hook is not in place (or you want to
bypass the hook script for some reason), you can also use the --bypass-hooks
option.  However, if you decide to use this option, be very careful.  You may
be bypassing such things as email notifications of the change, or backup
systems that keep track of revision properties.</p>

</div>


<div class="h3" id="patch" title="patch">
<h3>How do I submit a patch for Subversion?</h3>

<p>FIRST, read the <a href="hacking.html">Hacker's Guide to
Subversion</a>.</p> 

<p>Once you've digested that, send a mail to the dev list with the
word [PATCH] and a one-line description in the subject, and include
the patch inline in your mail (unless your MUA munges it up
totally). Then a committer will pick it up, apply it (making any
formatting or content changes necessary), and check it in.</p>

<p>The basic process looks like this:</p>

<blockquote><pre>
	$ svn co http://svn.collab.net/repos/svn/trunk subversion
	$ cd subversion/www

		[ make changes to faq.html ]
	
	$ svn diff faq.html &gt; /tmp/foo

	$ Mail -s "[PATCH] FAQ updates" &lt; /tmp/foo
</pre></blockquote>

<p>Of course, the email you send should contain a nice long
explanation about what the patch does, as per the
<a href="hacking.html">Hacker's Guide to Subversion</a>, but you
already know that, since you read and completely understood
it <em>before</em> actually hacking the code, right? :)</p>

</div>


<div class="h3" id="in-place-import" title="in-place-import">
<h3>How can I do an in-place 'import'
    (i.e. add a tree to Subversion such that the original data becomes
    a working copy directly)?</h3> 

<p>Suppose, for example, that you wanted to put some of /etc under
version control inside your repository:</p>

<pre>
     # svn mkdir file:///root/svn-repository/etc \
         -m "Make a directory in the repository to correspond to /etc"
     # cd /etc
     # svn checkout file:///root/svn-repository/etc .
     # svn add apache samba alsa X11 
     # svn commit -m "Initial version of my config files"
</pre>

<p>This takes advantage of a not-immediately-obvious feature of
<tt>svn&nbsp;checkout</tt>: you can check out a directory from the repository
directly into an existing directory.  Here, we first make a new empty directory
in the repository, and then check it out into <tt>/etc</tt>, transforming
<tt>/etc</tt> into a working copy.  Once that is done, you can use normal
<tt>svn&nbsp;add</tt> commands to select files and subtrees to add to the
repository.</p>

<p>There is an issue filed for enhancing <tt>svn&nbsp;import</tt> to
be able to convert the imported tree to a working copy automatically;
see <a href="http://subversion.tigris.org/issues/show_bug.cgi?id=1328"
>issue 1328</a>.</p>

</div>


<div class="h3" id="dumpload" title="dumpload">
<h3>人们在讨论升级Subversion服务器时所说的“转储/加载（dump/load）”是什么？</h3>

<p>Subversion's repository database schema has changed occasionally
during development. Old repositories, created with a pre-1.0
development version of Subversion, may require the following operation
when upgrading.  If a schema change happens between Subversion
releases X and Y, then repository administrators upgrading to Y must
do the following: </p>

<ol>
 <li>Shut down svnserve, Apache, and anything else that might be
     accessing the repository.
 </li>

 <li>
 <b>
 <tt>svnadmin&nbsp;dump&nbsp;/path/to/repository&nbsp;>&nbsp;dumpfile.txt</tt>
 </b>,
   using version X of svnadmin.
 </li>

 <li>
 <b>
 <tt>mv&nbsp;/path/to/repository&nbsp;/path/to/saved-old-repository</tt>
 </b>
 </li>

 <li>Now upgrade to Subversion Y (i.e., build and install Y, replacing X).
 </li>

 <li>
 <b><tt>svnadmin&nbsp;create&nbsp;/path/to/repository</tt></b>, using version
   Y of svnadmin.
 </li>

 <li>
 <b>
 <tt>svnadmin&nbsp;load&nbsp;/path/to/repository&nbsp;&lt;&nbsp;dumpfile.txt</tt>
 </b>,
   again using version Y of svnadmin.
 </li>

 <li>Copy over hook scripts, etc, from the old repository to the new one.
 </li>

 <li>Restart svnserve, Apache, etc.
 </li>
</ol>

<p> See
<a href="http://svnbook.red-bean.com/html-chunk/ch05s03.html#svn-ch-5-sect-3.4"
>http://svnbook.red-bean.com/html-chunk/ch05s03.html#svn-ch-5-sect-3.4</a>
for more details on dumping and loading.</p>

<p> <b>Note</b>: Most upgrades of Subversion do <i>not</i> involve a
dump and load.  When one is required, the release announcement and the
CHANGES file for the new version will carry prominent notices about
it.  If you don't see such a notice, then there has been no schema
change, and no dump/load is necessary. </p>

</div>

 
<div class="h3" id="sspi" title="sspi">
<h3>How do I allow clients to authenticate against a
    Windows domain controller using SSPI authentication?</h3>

<p><a href="http://tortoisesvn.tigris.org">TortoiseSVN</a> has an excellent
document that describes setting up a Subversion server on Windows. Go to
<a href="http://tortoisesvn.net/docs/release/TortoiseSVN_en/tsvn-serversetup.html#tsvn-serversetup-apache-5"
>http://tortoisesvn.net/docs/release/TortoiseSVN_en/tsvn-serversetup.html#tsvn-serversetup-apache-5</a>,
to see the section on SSPI authentication.</p>

<p>An important part of the configuration is the line:</p>
<pre>
   SSPIOfferBasic On
</pre>

<p>Without this line, browsers that support SSPI will prompt for the user's
credentials, but clients that do not suppport SSPI such as Subversion
will not prompt. (The current release of Neon - Subversion's HTTP
library - handles only basic authentication.)  Because the client never
asks for credentials, any action that requires authentication will fail.
Adding this line tells <tt>mod_auth_sspi</tt> to use basic authentication with
the client, but to use the Windows domain controller to authenticate
the credentials.</p>

</div>

  
<div class="h3" id="adm-dir" title="adm-dir">
<h3>I don't like the ".svn" directory name, and
    prefer "SVN" or something else.  How do I change it?</h3>

<p>We recommend that you live with ".svn" if you possibly can.
However, if you are using ASP.NET under Windows, you might need to set
the environment variable SVN_ASP_DOT_NET_HACK, as
described <a href="#vs-asp-net">here</a>.</p>

<p>Or you could use a completely custom name for the administrative
directory.  We recommend against this, because your working copy would
probably not work with Subversion clients other than the one you
customized.  However, if you absolutely must do this, just change this
line in <tt>subversion/include/svn_wc.h</tt> from</p>

<pre>
#define SVN_WC_ADM_DIR_NAME   ".svn"
</pre>

<p>
to (for example)
</p>

<pre>
#define SVN_WC_ADM_DIR_NAME   "SVN"
</pre>

<p>
then recompile your client.
</p>

</div>


<div class="h3" id="case-change" title="case-change">
<h3>How do I change the case of a filename?</h3>

<p>This problem comes up in two situations.  If you're adding files on
an operating system with a case-insensitive filesystem, such as
Windows, you might find you accidentally add a file with the wrong
case in the filename.  Alternatively, you may just decide to change
the case of an existing file in the repository.</p>

<p>If you're working in a case-sensitive file system, this is no
problem at all.  Just move the file to the new name, e.g.,</p>

<pre>
svn&nbsp;mv&nbsp;file.java&nbsp;File.java
</pre>

<p>But this won't work in a case-insensitive operating system like
Windows.  In Windows you can accomplish this by copying the file
somewhere temporary, deleting the file from Subversion, then adding
the copy with the correct case.  Or a better way is to perform a move
operation with Subversion URLs.  Using URLs is recommended, because it
will preserve history for the file, and will take effect
immediately.</p>

<p>Both ways will leave Windows working copies with problems, however,
because Windows can still get confused when trying to update the
conflicting filenames.  (You'll get a message like <tt>svn: Failed to
add file 'File.java': object of the same name already
exists</tt>). One way of fixing the problem is to delete your working
copy and check out again.  If you do not want to do this, you must
perform a two step update.</p>

<p>For each file with the wrong case, the following command will change
the case:</p>

<pre>
svn mv svn://svnserver/path/to/file.java svn://svnserver/path/to/File.java
</pre>

<p>To update the working copy, change to the relevant directory and do:</p>

<pre>
svn update file.java
svn update
</pre>

<p>The first update will remove <tt>file.java</tt> from your working
copy, the second update will add <tt>File.java</tt>, leaving you with
a correct working copy.  Or if you had a lot of problematic files, you
can update the working copy this way:</p>

<pre>
svn update *
svn update
</pre>

<p>As you can see, adding a file with the wrong case is tricky to fix on
an operating system that has a case insensitive filesystem.  Do try to
get it right when you add the file the first time!  To prevent the
problem from occurring in the first place, you can create a pre-commit hook that
calls the file <tt>check-case-insensitive.pl</tt>.  That file lives
in the Subversion
source tarball, in the directory <tt>contrib/hook-scripts</tt>.</p>

</div>


<div class="h3" id="merge-using-tags" title="merge-using-tags">
<h3>I can't use tags to merge changes from a 
    branch into the trunk like I used to with CVS, can I?</h3>

<p>As shown below it is possible to merge from a branch to the trunk
without remembering one revision number. Or vice versa (not shown in the
example).</p>

<p>The example below presumes an existing repository in <tt>/home/repos</tt> 
in which you want to start a branch named <tt>bar</tt> containing a file
named <tt>foo</tt> you are going to edit.</p>

<p>For the purpose of tracing branch merges, this repository has set up
<tt>tags/branch_traces/</tt> to keep tags.</p>

<pre># setup branch and tags
$ svn copy file:///home/repos/trunk \
           file:///home/repos/branches/bar_branch \
           -m "start of bar branch"
$ svn copy file:///home/repos/branches/bar_branch \
           file:///home/repos/tags/branch_traces/bar_last_merge \
           -m "start"

# checkout branch working copy
$ svn checkout file:///home/repos/branches/bar_branch wc
$ cd wc

# edit foo.txt file and commit
$ echo "some text" &gt;&gt;foo.txt
$ svn commit -m "edited foo"

# switch to trunk and merge changes from branch
$ svn switch file:///home/repos/trunk
$ svn merge file:///home/repos/tags/branch_traces/bar_last_merge \
            file:///home/repos/branches/bar_branch

# Now check the file content of 'foo.txt', it should contain the changes.

# commit the merge
$ svn commit -m "Merge change X from bar_branch."

# finally, update the trace branch to reflect the new state of things
$ svn delete -m "Remove old trace branch in preparation for refresh." \
             file:///home/repos/tags/branch_traces/bar_last_merge
$ svn copy file:///home/repos/branches/bar_branch                     \
           file:///home/repos/tags/branch_traces/bar_last_merge       \
           -m "Reflect merge of change X."
</pre>

</div>


<div class="h3" id="version-value-in-source" title="version-value-in-source">
<h3>Why doesn't the $Revision$
keyword do what I want?  It expands to the file's last-changed revision,
but I want something that will expand to the file's current revision.</h3>

<p>
Subversion increments the revision number of the repository as a
whole, so it can't expand any keyword to be that number - it would
have to search and possibly modify every file in your working copy on
every update and commit.
</p>

<p>
The information you want (the revision of your working copy) is
available from the command <tt>svnversion</tt>; it gives you
information on the revision level of a working copy given a path (see
<tt>svnversion --help</tt> for details). 
</p>

<p>
You can incorporate it into your build or release process to get the
information you need into the source itself.  For example, in a build
environment based on <tt>GNU&nbsp;make</tt>, add <a
href="http://subversion.tigris.org/servlets/ReadMsg?list=dev&amp;msgNo=112564"
>something like this</a> to your <tt>Makefile</tt>:
</p>

<pre>
##
## To use this, in yourfile.c do something like this:
## printf("this program was compiled from SVN revision %s\n",SVN_REV);
##

SVNDEF := -D'SVN_REV="$(shell svnversion -n .)"'
CFLAGS := $(SVNDEF) ... continue with your other flags ...
</pre>

<p>
(Note that this will not work on non-GNU versions of <tt>make</tt>.
Don't use it if your build process needs to be portable.)</p>

<p>Or try this recipe:</p>

<pre>
##
## on every build, record the working copy revision string
##
svn_version.c: FORCE
    echo -n 'const char* svn_version(void) { const char* SVN_Version = "' \
                                       &gt; svn_version.c
    svnversion -n .                   &gt;&gt; svn_version.c
    echo '"; return SVN_Version; }'   &gt;&gt; svn_version.c

##
## Then any executable that links in <tt>svn_version.o</tt> will be able
## to call the function <tt>svn_version()</tt> to get a string that
## describes exactly what revision was built.
##
</pre>

<p>
Windows users may want to use <tt>SubWCRev.exe</tt>, available from
the <a
href='http://tortoisesvn.net/downloads'>TortoiseSVN
download page</a>; it replaces all <tt>$WCREV$</tt> tags in a given
file with the current working copy revision.
</p>

</div>


<div class="h3" id="log-in-source" title="log-in-source">
<h3>Does Subversion have a keyword which
behaves like $Log$ in CVS?</h3>

<p>No.  There is no equivalent for the $Log$ keyword in CVS.  If you
want to retrieve a log for a specific file, you can run
'svn log your-file-name' or 'svn log url-to-your-file'.
From the mailing list some explanations why $Log$ is bad:</p>

<pre>"$Log$ is a total horror the moment you start merging changes
between branches. You're practically guaranteed to get conflicts there,
which -- because of the nature of this keyword -- simply cannot be
resolved automatically."</pre>

<p>And:</p>

<pre>Subversion log messages are mutable, they can be changed by setting
the svn:log revision property. So the expansion of $Log:$ in any
given file could be out of date. Update may well need to retrieve the
appropriate log message for each occurrence of the $Log:$ keyword,
even if the file that contained it was not otherwise updated.</pre>

<p><i>I don't care about that.  I want to use it anyway.
Will you implement it?</i></p>

<p>No.  There are no plans to implement it ourselves or accept patches
which implement this feature.  If you want to distribute your files
with some kind of changelog included, you might be able to work
around this limitation in your build system.</p>

</div>



<div class="h3" id="ignore-commit" title="ignore-commit">
<h3>在我的工程里有一个文件，每个人都必须改变它，但是我不希望他们本地的修改被提交，如何让'svn commit'忽略这个文件？</h3>

<p>The answer is: don't put that file under version control.  Instead,
put a <em>template</em> of the file under version control, something
like "file.tmpl".</p>

<p>Then, after the initial 'svn checkout', have your users (or your
build system) do a normal OS copy of the template to the proper
filename, and have users customize the copy.  The file is unversioned,
so it will never be committed.  And if you wish, you can add the file
to its parent directory's svn:ignore property, so it doesn't show up
as '?'  in the 'svn status' command.</p>

</div>


<div class="h3" id="ssh-auth-cache" title="ssh-auth-cache">
<h3>When I access a repository using
svn+ssh, my password is not cached in ~/.subversion/auth/.  How do
I avoid having to type it so often?</h3>

<p>ssh has its own passphrases and its own authentication-caching
scheme.  Its auth caching is external to Subversion, and must be set
up independently of Subversion.</p>

<p>OpenSSH includes <b><tt>ssh-keygen</tt></b> to create the keys,
<b><tt>ssh-agent</tt></b> to cache passphrases, and
<b><tt>ssh-add</tt></b> to add passphrases to the agent's cache.  A
popular script to simplify usage of <tt>ssh-agent</tt> is
<b><tt>keychain</tt></b>.  On Windows, <b><tt>PuTTY</tt></b> is a
popular alternative ssh client; see <b><tt>PuTTYgen</tt></b> to import
OpenSSH keys and <b><tt>pageant</tt></b> to cache passphrases.</p>

<p>Setting up <tt>ssh-agent</tt> is outside the scope of this
document, but a <a
href="http://www.google.com/search?hl=en&amp;lr=&amp;ie=UTF-8&amp;q=%22ssh-agent%22"
>Google search for "ssh-agent"</a> will quickly get you answers.  Or
if you're <i>really</i> impatient, try one of these:</p>

<pre>
   <a href="http://mah.everybody.org/docs/ssh"
           >http://mah.everybody.org/docs/ssh</a>
   <a href="http://kimmo.suominen.com/docs/ssh/"
           >http://kimmo.suominen.com/docs/ssh/</a>
</pre>

</div>


<div class="h3" id="ssh-svnserve-location" title="ssh-svnserve-location">
<h3>我的<tt>svnserve</tt>二进制程序不在我的用户的默认<tt>路径</tt>中，他们使用svn+ssh，我不知道怎样修改他们的路径来让他们运行<tt>svnserve</tt>。</h3>

      <p>Note: this all assumes you're using OpenSSH.  There are other
      ssh implementations out there, and presumably they will allow
      you to do something similar, but we don't yet know the details.</p>
      
      <p>You've tried fiddling with their various login files, like
        <tt>.bash_profile</tt>, and nothing works!  That's because ssh
        ignores those files when the Subversion client invokes it.
        But there's no need to modify <tt>PATH</tt>; instead, you can
        directly give ssh the full name of the <tt>svnserve</tt> command.
        Here's how to do it:</p>

      <p>For each user who needs svn+ssh access, generate a new ssh
        public-key pair which they will use <em>only</em> for
        Subversion&mdash;not for logging in normally.  Have them give
        the keypair a distinctive name, like
        <tt>~/.ssh/id_dsa.subversion</tt>.  Add the public part of the
        key to their <tt>~/.ssh/authorized_keys</tt> file on the
        server machine, after first inserting a bit of magic at the
        beginning of the line before the word <tt>ssh-rsa</tt> or
        <tt>ssh-dss</tt>, like this:</p>

      <table border="1" cellspacing="2" cellpadding="2">
        <tr><th>before</th></tr>
        <tr><td><tt>ssh-dss&nbsp;AAAAB3Nblahblahblahblah</tt></td></tr>
        <tr><th>after</th></tr>
        <tr><td><tt>
        command="/opt/subversion/bin/svnserve&nbsp;-t"&nbsp;ssh-dss&nbsp;AAAAB3Nblahblahblahblah
        </tt></td></tr>
      </table>

      <p>Obviously, replace <tt>/opt/subversion/bin/svnserve</tt> with
      whatever is appropriate for your system.  You also might want to
      specify the full path to the Subversion repository in the
      command (by using the <tt>-r</tt> option), to save your users
      some typing.</p>
      
      <p>The <tt>command=</tt> magic causes sshd on the remote machine
        to invoke <tt>svnserve</tt>, even if your user tries to run
        some other command.  See the sshd(8) man page (section
        <tt>AUTHORIZED_KEYS FILE FORMAT</tt>) for details.</p>
      
      <p>Now when your users run the Subversion client, make sure they
      have an <tt>SVN_SSH</tt> environment variable that "points to"
      the private half of their keypair, by doing something like this
      (for the Bourne Again shell):</p>

<pre>
SVN_SSH="ssh -i $HOME/.ssh/id_dsa.subversion"
export SVN_SSH
</pre>

      <p><a
      href="http://svn.collab.net/repos/svn/trunk/notes/ssh-tricks">This
      file</a> discusses this topic in more detail.</p>
      
</div>


<div class="h3" id="ssh-authorized-keys-trick" title="ssh-authorized-keys-trick">
<h3>我希望允许通过svn+ssh://来访问版本库，但我很忧虑。我讨厌为每个用户分配一个登录帐号的方法，那样我会为他们是否允许访问我的机器感到担心。</h3>
<p>See the section about hacking
the <tt>~/.ssh/authorized_keys</tt> file in the answer
to <a href="#ssh-svnserve-location">this other question</a>; ignore the stuff
about getting <tt>svnserve</tt> on your PATH.</p>
</div>      


<div class="h3" id="auto-props" title="auto-props">
<h3>How can I set certain properties on
everything in the repository?  Also, how can I make sure that every
new file coming into the repository has these properties?</h3>

<p>Subversion will not change a file's contents by default; you have
to deliberately set the <tt>svn:eol-style</tt> or
<tt>svn:keywords</tt> property on a file for that to happen.  That
makes Subversion a lot safer than CVS's default behavior, but with
that safety comes some inconvenience.</p>

<p>Answering the first question: to set properties on all files
already in the repository, you'll need to do it the hard way.  All you
can do is run <tt>svn propset</tt> on every file (in a working copy),
and then <tt>svn commit</tt>.  Scripting can probably help you with
this.</p>

<p>But what about future files?  Unfortunately, there's no server
mechanism to automatically set properties on files being committed.
This means that all of your users need to remember to set certain
properties whenever they <tt>svn add</tt> a file.  Fortunately,
there's a client-side tool to help with this.  Read about the <a
href="http://svnbook.red-bean.com/svnbook-1.1/ch07s02.html#svn-ch-7-sect-2.4">
auto-props</a> feature in the book.  You need to make sure all your
users configure their clients' auto-props settings appropriately.</p>

<p>You could write a pre-commit hook script to reject any commit which
forgets to add properties to new files (see <a
href="http://svn.collab.net/repos/svn/trunk/contrib/hook-scripts/check-mime-type.pl"
>http://svn.collab.net/repos/svn/trunk/contrib/hook-scripts/check-mime-type.pl</a>
for example).  However, this approach may be overkill.  If somebody
forgets to set <tt>svn:eol-style</tt>, for example, it will be noticed
the minute somebody else opens the file on a different OS.  Once
noticed, it's easy to fix: just set the property and commit.</p>

<p>Note: many users have asked for a feature whereby the server
automatically "broadcasts" run-time settings to clients, such as
auto-props settings.  There's already a feature request filed for this
(<a
href="http://subversion.tigris.org/issues/show_bug.cgi?id=1974">issue
1974</a>), though this feature is still being debated by developers,
and isn't being worked on yet.</p>

</div>


<div class="h3" id="svn-editor" title="auto-props">
<h3>How do I deal with spaces in the editor path?&nbsp; Also, how can
I define command line options for the editor?</h3>

<p>The Subversion command line client will invoke the editor defined
in the environment variable SVN_EDITOR.&nbsp; This environment variable
is passed directly to the operating system along with the name of a
temporary file used to enter/edit the log message.</p>

<p>Due to the fact that the SVN_EDITOR string is passed as-is to the
system's command shell, spaces in the editor name, or in the path name
to the editor, will not work unless the editor name is in quotes.</p>

<p>For example, on Windows if your editor is in
<code>C:\Program&nbsp;Files\Posix&nbsp;Tools\bin\vi</code> you would
want to set the variable as follows:
</p>
<pre>
   set SVN_EDITOR="C:\Program Files\Posix Tools\bin\vi"
</pre>

<p>Note that there is no need to escape the quotes in the Windows
shell as they are not part of the syntax for the <code>set</code>
command.
</p>

<p>On UNIX systems you would need to follow your shell's specific
methods for setting the variable.&nbsp; For example, in a bash shell,
the following should work:
</p>
<pre>
   SVN_EDITOR='"/usr/local/more editors/bin/xemacs"'
   export SVN_EDITOR
</pre>

<p>In case a command line option would be needed for the invocation
of the editor, just add that after the editor name in the SVN_EDITOR
environment variable just like you would us on the command line.&nbsp;
For example, if the options <code>-nx -r</code> would be wanted for
the above editors, the following will provide those options:
</p>

<p>For Windows:</p>
<pre>
   set SVN_EDITOR="C:\Program Files\Posix Tools\bin\vi" -nx -r
</pre>

<p>For UNIX/bash:</p>
<pre>
   SVN_EDITOR='"/usr/local/more editors/bin/xemacs" -nx -r'
   export SVN_EDITOR
</pre>

<p>Note that SVN_EDITOR is the Subversion specific environment variable
setting for the editor selection.&nbsp; Subversion also supports
using the more generic EDITOR variable but if you need special behaviors
with Subversion it is best to use the SVN_EDITOR variable.
</p>

</div>


<div class="h3" id="divining-bdb-version" title="divining-bdb-version">
<h3>How do I determine which version of
Berkeley DB a repository is using?</h3>

<p>If it's a live repository, then the easy answer is "Whatever
version of Berkeley DB you have installed".  If, however, it is a
repository from a backup, or some unknown source, and you have no idea
which version of Berkeley DB it was made with, here's how you find
out:</p>

<p>Run some command to view the two 4-byte integers at offsets 12 and
16 (decimal) in the highest-numbered db/log.* file in the repository.
Here is an example using GNU od: "<tt>od -j12 -N8 -tx4
log.<i>&lt;number&gt;</i></tt>".  Here is an example using Mac OS X
hexdump: "<tt>hexdump -s12 -n8 -x log.<i>&lt;number&gt;</i></tt>".
The first integer should be the magic number 0x00040988, which
identifies the file as a Berkeley DB logfile.  The second number is
the log format version
- match it to a Berkeley DB version using the table below:</p>

<table border="1" cellspacing="2" cellpadding="2">
  <tr><th>Log format version</th><th>Berkeley DB version</th></tr>
  <tr><td>5 (0x00000005)</td><td>4.0</td></tr>
  <tr><td>7 (0x00000007)</td><td>4.1</td></tr>
  <tr><td>8 (0x00000008)</td><td>4.2</td></tr>
  <tr><td>10 (0x0000000a)</td><td>4.3</td></tr>
  <tr><td>11 (0x0000000b)</td><td>4.4</td></tr>
  <tr><td>12 (0x0000000c)</td><td>4.5</td></tr>
  <tr><td>13 (0x0000000d)</td><td>4.6</td></tr>
</table>

</div>


<div class="h3" id="website-auto-update" title="website-auto-update">
<h3>I'm managing a website in my
repository.  How can I make the live site automatically update after
every commit?</h3>

<p>This is done all the time, and is easily accomplished by adding a
post-commit hook script to your repository.  Read about hook scripts
in <a
href="http://svnbook.red-bean.com/en/1.1/ch05s02.html#svn-ch-5-sect-2.1">Chapter
5</a> of the book.  The basic idea is to make the "live site" just an
ordinary working copy, and then have your post-commit hook script run
'svn update' on it.</p>

<p>In practice, there are a couple of things to watch out for.  The
server program performing the commit (svnserve or apache) is the same
program that will be running the post-commit hook script.  That means
that this program must have proper permissions to update the working
copy.  In other words, the working copy must be owned by the same user
that svnserve or apache runs as -- or at least the working copy must
have appropriate permissions set.</p>

<p>If the server needs to update a working copy that it doesn't own
(for example, user joe's ~/public_html/ area), one technique is create
a +s binary program to run the update, since Unix won't allow scripts
to run +s.  Compile a tiny C program:</p>

<pre>
#include &lt;stddef.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;unistd.h&gt;
int main(void)
{
  execl("/usr/local/bin/svn", "svn", "update", "/home/joe/public_html/",
        (const char *) NULL);
  return(EXIT_FAILURE);
}
</pre>

<p>... and then <tt>chmod +s</tt> the binary, and make sure it's owned
by user 'joe'.  Then in the post-commit hook, add a line to run the
binary.</p>

<p>If you have problems getting the hook to work, see <a
href="#hook-debugging">"Why aren't my repository hooks
working?"</a>.</p>

<p>Also, you'll probably want to prevent apache from exporting the
.svn/ directories in the live working copy.  Add this to your
<tt>httpd.conf</tt>:</p>

<pre>
# Disallow browsing of Subversion working copy administrative dirs.
&lt;DirectoryMatch "^/.*/\.svn/"&gt;
    Order deny,allow
    Deny from all
&lt;/DirectoryMatch&gt;
</pre>

</div>


<div class="h3" id="single-file-checkout" title="single-file-checkout">
<h3>How do I check out a single file?</h3>

<p>Subversion does not support checkout of a single file, it only
supports checkout of directory structures.</p>

<p>However, you can use 'svn export' to export a single file.  This will
retrieve the file's contents, it just won't create a versioned working
copy.</p>

</div>


<div class="h3" id="wc-change-detection" title="wc-change-detection">
<h3>How do I detect adds, deletes,
copies and renames in a working copy after they've already
happened?</h3>

<p>You don't.  It's a bad idea to try.</p>

<p>The basic design of the working copy has two rules: (1) edit files
as you please, and (2) use a Subversion client to make any
tree-changes (add, delete, move, copy).  If these rules are followed,
the client can sucessfully manage the working copy.  If renames or
other rearrangements happen outside of Subversion, then the UI has
been violated and the working copy might be broken.  The client cannot
guess what happened.</p>

<p>People sometimes run into this problem because they want to make
version control "transparent".  They trick users into using a working
copy, then have a script run later that tries to guess what happened
and run appropriate client commands.  Unfortunately, this technique
only goes a short distance.  'svn status' will show missing items and
unversioned items, which the script can then automatically 'svn rm' or
'svn add'.  But if a move or copy has happened, you're out of luck.
Even if the script has a foolproof way of detecting these things, 'svn
mv' and 'svn cp' can't operate after the action has already
occurred.</p>

<p>In summary: a working copy is wholly under Subversion's control,
and Subversion wasn't designed to be transparent.  If you're looking
for transparency, try setting up an apache server and using the
"SVNAutoversioning" feature described in appendix C of the book.  This
will allow users to mount the repository as a network disk, and any
changes made to the volume cause automatic commits on the server.</p>

</div>


<div class="h3" id="svnserve-win-service" title="svnserve-win-service">
<h3>How do I run svnserve as a service
on Windows?</h3>

<p>For versions 1.4.0 and later, you can find
instructions <a
href="http://svn.collab.net/repos/svn/trunk/notes/windows-service.txt">here</a>.</p>

<p>In versions before 1.4.0, the <tt>svnserve</tt> binary itself could
not be installed as a Windows service, but there are a number of
&ldquo;service wrappers&rdquo; that can do the job; for example:</p>

<ul>
<li><a href="http://www.clanlib.org/~mbn/svnservice/">SVNService</a>
is a free tool written by Magnus Norddahl</li>
<li><a href="http://support.microsoft.com/kb/q137890/">SrvAny</a>
is avaliable free of charge from Microsoft</li>
</ul>

<p>There is a bit more about running <tt>svnserve</tt> as a service in
<a
href="http://tortoisesvn.net/docs/release/TortoiseSVN_en/tsvn-serversetup-svnserve.html">the
TortoiseSVN manual</a>.</p>

</div>


<div class="h3" id="bdb-fsfs-convert" title="bdb-fsfs-convert">
<h3>How do I convert my repository from using BDB
to FSFS or from FSFS to BDB?</h3>

<p>There are three steps:</p>

<ol>
  <li>A <a href="#dumpload">dump/load</a> from the old format to the new
  one.</li>
  <li>Copy the hook scripts.</li>
  <li>Copy the configuration files.</li>
</ol>

<p>Say you have a repository <tt>/svn/myrepos</tt> which is using the BDB
backend and you would like to switch to using the FSFS backend:</p>

<ol>
  <li>Close down your server so that the data cannot change during this
  procedure.</li>
  <li>Make a new repository specifying the fsfs backend (it is the default
  from 1.2 onwards), e.g., <tt>svnadmin create /svn/myreposfsfs --fs-type
  fsfs</tt>.</li>
  <li>Pipe the output of a dump from <tt>/svn/myrepos</tt> to the input of a
  load into <tt>/svn/myreposfsfs</tt>, e.g., <tt>svnadmin dump /svn/myrepos
  -q | svnadmin load /svn/myreposfsfs</tt>.  Windows users should dump
  to a file and load from that file in two separate steps.</li>
  <li>Copy any hook scripts which are active in <tt>/svn/myrepos/hooks</tt>
  into <tt>/svn/myreposfsfs/hooks</tt>.  Don't mindlessly copy everything, the
  templates generated by Subversion may have changed.</li>
  <li>Compare the template scripts which the <tt>svnadmin create</tt> command
  put in <tt>/svn/myreposfsfs/hooks</tt> with those in
  <tt>/svn/myrepos/hooks</tt> and incorporate any changes which you would like
  into your active hook scripts.</li>
  <li>Copy configuration files from <tt>/svn/myrepos/conf</tt>
  into <tt>/svn/myreposfsfs/conf</tt> (and don't forget a password
  file, if you use one).  Or you might instead want to merge
  the <em>changes</em> that you made to your configuration files into
  the new default ones.</li>
  <li>Rename <tt>/svn/myrepos</tt> to <tt>/svn/myreposbdb</tt> and then
  <tt>/svn/myreposfsfs</tt> to <tt>/svn/myrepos</tt> ensuring that the
  file permissions are the same as those  that the BDB version had.</li>
  <li>Restart the server.</li>
</ol>

<p>Once you are happy that all is well with your new repository delete the old
one.</p>

<p>To do the reverse and migrate from FSFS to BDB change the <tt>svnadmin
create</tt> command to specify BDB.</p>

</div>
 
<div class="h3" id="binary-files" title="binary-files">
<h3>How does Subversion handle binary files?</h3>

<p>When you first add or import a file into Subversion, the file is
examined to determine if it is a binary file.  Currently, Subversion
just looks at the first 1024 bytes of the file; if any of the bytes
are zero, or if more than 15% are not ASCII printing characters, then
Subversion calls the file binary.  This heuristic might be improved in
the future, however.</p>

<p>If Subversion determines that the file is binary, the file receives
an svn:mime-type property set to "application/octet-stream".  (You can
always override this by using the <a
href="http://svnbook.red-bean.com/svnbook-1.1/ch07s02.html#svn-ch-7-sect-2.4"
>auto-props feature</a> or by setting the property manually with
<tt>svn propset</tt>.)</p>

<p>Subversion treats the following files as text:</p>

<ul>
  <li>Files with no svn:mime-type</li>
  <li>Files with a svn:mime-type starting "text/"</li>
  <li>Files with a svn:mime-type equal to "image/x-xbitmap"</li>
  <li>Files with a svn:mime-type equal to "image/x-xpixmap"</li>
</ul>

<p>All other files are treated as binary, meaning that Subversion will:</p>

<ul>
  <li>Not attempt to automatically merge received changes with local
      changes during <tt>svn update</tt> or <tt>svn merge</tt></li>
  <li>Not show the differences as part of <tt>svn diff</tt></li>
  <li>Not show line-by-line attribution for <tt>svn blame</tt></li>
</ul>

<p>In all other respects, Subversion treats binary files the same as
text files, e.g. if you set the svn:keywords or svn:eol-style
properties, Subversion will perform keyword substitution or newline
conversion on binary files.</p>

<p>Note that whether or not a file is binary does not affect the
amount of repository space used to store changes to that file, nor
does it affect the amount of traffic between client and server.  For
storage and transmission purposes, Subversion uses a diffing method
that works equally well on binary and text files; this is completely
unrelated to the diffing method used by the 'svn&nbsp;diff'
command.</p>

</div>

<div class="h3" id="terse-diff" title="terse-diff">
<h3>How can I make <tt>svn diff</tt> show me just the names of the
changed files, not their contents?</h3>
<p>
<tt>svn diff</tt> doesn't have an option to do this, but 
</p>
<ul>
<li>
  If you only are interested in the diffs between, say, revision 10
  and the revision just before it, <pre>svn log -vq -r10</pre> does
  exactly what you want;
</li>
<li>
  otherwise, if you're using Unix, this works for any range of revisions:
  <pre>
    svn log -vq -r123:456 | egrep '^ {3}[ADMR] ' | cut -c6- | sort | uniq </pre> </li>
</ul>
Version 1.4 of the <tt>svn diff</tt> command will have a "--summarize"
option.
</div>

<div class="h3" id="sorry-no-globbing" title="sorry-no-globbing">
<h3>我如何使用通配符（wildcards）或者点号来一次性移动我的文件？</h3>
<p>
你或许是想做这样一些事情
</p>
<pre>
svn mv svn://server/trunk/stuff/* svn://server/trunk/some-other-dir
</pre>
<p>
但是却失败了 
</p>
<pre>
svn: Path 'svn://server/trunk/stuff/*' does not exist in revision 123
</pre>
<p>
... 或者还有其他一些看起来不可理解的错误信息。
</p>

<p>
简而言之，不幸的是：Subversion没有内置这样的方法来进行这样一种操作；许多其他的命令 ，像是 <tt>mv</tt>， refuse to take an arbitrary number of
arguments ... and in any case, Subversion doesn't expand wildcards like
"*" the way the shell does.
</p>

<p>
If you happen to have a working copy that contains all the source
files as well as the destination directory, then you can exploit your
shell's wildcard feature to do the move, like this (for Bash):
</p>
<pre>
  for i in stuff/*; do svn mv $i some-other-dir; done
  svn ci -m "moved all the stuff into some other dir"
</pre>

<p>
In any case, you can always accumulate a list of the names of the
source files, and then run "svn mv" on each item in that list, like
this:
</p>
<pre>
        s=svn://server/trunk/stuff/
        svn ls "$s"  | \
        while read f
           do svn mv "$s/$f" svn://server/trunk/some-other-dir -m "Moved just one file"
        done
</pre>
<p>
Note, however, that this will generate one commit per source file;
that's in contrast to the above method (using a working copy) which
generates just one commit total.
</p>

<p>
There is a program called "svnmucc" or "mucc" depending upon which
version of Subversion you have, whose source is distributed with
Subversion (in ...<tt>/contrib/client-side/mucc/mucc.c</tt> for
Subversion 1.4 or earlier, in
...<tt>/contrib/client-side/svnmucc/svnmucc.c</tt> for Subversion 1.5
or later), that appears to solve this problem for you.
</p>

<p>
<b>Note:</b> with release 1.5, Subversion in fact allows you to "cp" and "mv"
multiple files at once.
</p>
</div>

<div class="h3" id="vendor-branch" title="vendor-branch">
<h3>我如何用Subversion维护一个由第三方不断修正版本的软件呢？(a
    "vendor分支")？</h3>

<p>人们通常希望使用Subversion去跟踪他们的变化的第三方代码，甚至从第三的代码进行升级，换句话说，他们想维护他们自己的一个分支，与此同时仍然希望从上游的代码并入新的发布。这通常被叫做<em>vendor branch</em>
(the term long predates Subversion), 并且这项技术也是Subversion之一，在 <a
href="http://svnbook.red-bean.com/en/1.4/svn-book.html#svn.advanced.vendorbr"
>有详细的描述</a>.</p>

<p>如果vendor代码是远程的主机上的Subversion版本库，你可以使用<a href="http://piston.rubyforge.org/">Piston</a>来
管理你的vendor's code拷贝.</p>

<p>最后，如果使用<tt>svn_load_dirs.pl</tt>花太多时间的话，或者你正在寻找一个lazy solution，则可以参考Jon
Stevens' step-by-step的介绍<a
href="http://lookfirst.com/2007/11/subversion-vendor-branches-howto.html"
>如何使用Subversion Vendor Branches</a>。这种解决方案在你拷贝新的代码去覆盖旧的代码的时候并不能 This solution does not make
use of the space saving features in the Subversion backend；在这种解决方案中，每一个导入的vendor
code得到一个实体的拷贝并且没有空间保存同样的文件。</p>

</div>

</div>

<div class="h2" id="troubleshooting" title="troubleshooting">
<h2>Troubleshooting:</h2>
<p/>


<div id="permissions"></div>
<div class="h3" id="stuck-bdb-repos" title="stuck-bdb-repos">
<h3>My repository seems to get stuck all the
time, giving me errors about needing recovery (DB_RUNRECOVERY). What
could be the cause?</h3>

<p>版本库使用的Berkeley DB数据库来存储数据，而后者很容易被破环。
如果进程退出时没有正常关闭数据库，那么数据库就处在非正常状态中。
常见的原因可能是：</p>

<ul>
  <li>进程遇到访问权限问题而退出时</li>
  <li>进程崩溃或段错误</li>
  <li>进程被强制杀死</li>
  <li>磁盘空间用尽</li>
</ul>

<p>多数情况下，你可以执行"svnadmin recover", 这个命令可以将版本库回退到
上一个正常状态，详细解释请见</a>。注意，当频繁
checkout和update且磁盘空间用尽的时候，可能导致版本库处于无法回复的状态
（所以请多做备份）。</p>

<p>进程崩溃，被杀死以及磁盘空间用尽都是极端情况。访问权限问题可能是更
常见的原因：当一个进程访问版本库且改变了版本库的所有者或访问权限，那么
另一个访问这个版本库的进程可能被阻塞在访问权限上。</p>

<p>避免这种情况出现的最好办法是正确设置你的版本库的所有者和权限。
<a href="#reposperms">更多信息请见</a>。</p>

</div>


<div id="wedged-repos"></div>
<div class="h3" id="bdb-recovery" title="bdb-recovery">
<h3>Every time I try to access my repository, the
process just hangs. Is my repository corrupt?</h3>

<p>你的版本库没有坏掉，数据也没有丢失。当你的进程直接访问版本库
(mod_dav_svn, svnlook, svnadmin, 或通过`file://')的时候，进程将
直接调用Berkeley DB程序库来访问版本库。Berkekey DB包含日志系统，
也就是说所有的操作在执行前都被记录在日志中。当你的进程崩溃
(Control-C,或段错误），遗留下文件锁，它记录了所有未完成操作的信息。
此时所有试图访问数据库的进程将因为要访问文件锁而被挂起。要想解除文件锁，
你可以调用Berkeley DB来完成所有未完成的操作或者回退到前一个正常状态。</p>

<p><b><span style="color: red">警告:</span>版本库可能被严重损坏，当一个进程
正在访问版本库，而你又试图恢复版本库的时候。</b></p>

<p>在你恢复数据库之前，请确保没有其他进程在访问版本库(关闭Apache, 去掉'svn'的执行权限)
。请确保你是正确的用户（数据库的拥有者和管理者的用户），而不是root用户。
否则数据库将只能被root用户访问，而其他用户（你自己或Apache）将无法对数据库进行操作。
同时，还要确保umask被正确设置，否则其他隶属与可以访问该数据库的组的用户可能无法
对数据库进行操作。</p>

<p>
执行:</p>

<pre>
   svnadmin recover /path/to/repos
</pre>

<p>当命令执行完毕, 检查版本库<code>db</code>目录的访问权限</p>

<p>有时"svnadmin&nbsp;recover"会失败，错误信息如下:</p>

<pre>
  Repository lock acquired.
  Please wait; recovering the repository may take some time...
  svnadmin: DB_RUNRECOVERY: Fatal error, run database recovery
  svnadmin: bdb: Recovery function for LSN 175 7066018 failed on backward pass
  svnadmin: bdb: PANIC: No such file or directory
  svnadmin: bdb: PANIC: fatal region error detected; run recovery
</pre>

<p>或者:</p>

<pre>
  Repository lock acquired.
  Please wait; recovering the repository may take some time...
  svn: DB_RUNRECOVERY: Fatal error, run database recovery
  svn: bdb: DB_ENV-&gt;log_flush: LSN of 115/802071 past current end-of-log
  of 115/731460
  svn: bdb: Database environment corrupt; the wrong log files may have
  been removed or incompatible database files imported from another
  environment
  [...]
  svn: bdb: changes: unable to flush page: 0
  svn: bdb: txn_checkpoint: failed to flush the buffer cache Invalid argument
  svn: bdb: PANIC: Invalid argument
  svn: bdb: PANIC: fatal region error detected; run recovery
  svn: bdb: PANIC: fatal region error detected; run recovery
  [...]
</pre>

<p>这种情况下可以试试Berkeley DB的工具<b>db_recover</b>
(参见<a href="http://www.oracle.com/technology/documentation/berkeley-db/db/utility/db_recover.html"
>db_recover文档</a>).这个命令通常在Berkeley DB安装目录的子目录"bin/"中,
例如你从源代码安装的Berkeley DB,命令可能是
<tt>/usr/local/BerkeleyDB.4.2/bin/db_recover</tt>;或在某些系统中预安装的Berkeley DB，可能是
<tt>/usr/bin/db_recover</tt>.如果你的系统中安装了多个版本的
Berkeley DB,请确保使用匹配版本库的Berkeley DB版本</p>

<p>执行db_recover，附带参数"-c" ("灾难恢复").你还可以附带
"-v"来看到执行的详细信息, "-h"指定被恢复的数据库。例如:</p>

<pre>
   db_recover -c -v -h /path/to/repos/db
</pre>

<p>用版本库的拥有者的帐号执行这个命令，同时，请绝对确保没有其他进程在
访问版本库。(例如，关闭svnserve或).</p>

</div>


<div class="h3" id="bdb-cannot-allocate-memory" title="bdb-cannot-allocate-memory">
<h3>My repository keeps giving errors saying "Cannot allocate memory".
     What should I do?</h3>

<p>如果你通过http://来访问版本库，"<b>Cannot allocate memory</b>"应该出现在httpd
服务器的日志中，像如下这样:</p>

<blockquote>
<pre>
[Wed Apr 07 04:26:10 2004] [error] [client 212.151.130.227] (20014)
Error string not specified yet: Berkeley DB error while opening 
'strings' table for filesystem /usr/local/svn/repositories/svn/db: 
Cannot allocate memory
[Wed Apr 07 04:26:10 2004] [error] [client 212.151.130.227] 
Could not fetch resource information.  [500, #0]
[Wed Apr 07 04:26:10 2004] [error] [client 212.151.130.227] 
Could not open the requested SVN filesystem  [500, #160029]     
[Wed Apr 07 04:26:10 2004] [error] [client 212.151.130.227] (17) 
File exists: Could not open the requested SVN filesystem  [500, #160029]
</pre>
</blockquote>

<p>这通常表示Berkeley DB版本库用光了所有数据库锁（FSFS版本库不会出现这种情况）
。通常的运行过程中不应该出现这种情况，如果确实出现了，解决办法是用本文中
描述的方法来<a href="#bdb-recovery">恢复数据库</a>。如果这种情况时常发生，
你很可能应该提高db/DB_CONFIG文件中锁设置(<tt>set_lk_max_locks</tt>,
<tt>set_lk_max_lockers</tt>, and <tt>set_lk_max_objects</tt>)
的默认值。改变已存在的版本库的DB_CONFIG配置后，记得恢复数据库。</p>

</div>


<div class="h3" id="wedged-wc" title="wedged-wc">
<h3>Every time I try to run a svn command, it says my
working copy is locked. Is my working copy corrupt?</h3>

<p>
你的工作拷贝没有坏掉，数据也没有丢失。Subversion的工作拷贝是一个
日志系统，所有的操作在执行之前都被记录在日志中。如果svc客户端程序被
强制中止(段错误或杀进程，不包括Control-C)，会有多个文件锁遗留下来，记录了
未完成的操作。('svn status'命令会在被是锁定目录后显示'L'。)其他
试图访问工作拷贝的进程看到这些锁后会返回操作失败。想解锁你的工作拷贝，需要
让svn客户端完成未完的操作。执行:</p>

<pre>
svn cleanup working-copy
</pre>

</div>


<div class="h3" id="wc-out-of-date" title="wc-out-of-date">
<h3>我试图去提交，但是Subversion说我的工作拷贝是过时的？</h3>

<p>三种情况下会出现这个问题</p>

<ol>

<li><p>提交失败导致了你的工作拷贝被破环。</p>

    <p>在你提交时，新版本被添加到服务器上，然后你的客户端执行提交后的
    管理任务（包括刷新本地拷贝）。在第二个操作之前，你的提交处在一个“过期”
    的状态之中。导致这种情况发生的原因有，（极少数情况下）数据库一端出现
    了问题，（大多数情况下）网络在错误的时间中断了。</p>

    <p>这时，很可能你的提交已经成功了。你可以执行"svn log -rHEAD"来查看
    提交是否真的成功了。如果成功了，执行“svn revert”，回退本地修改，然后
    执行“svn update”来取回你已经提交的修改。（注意，“svn update”能更新你的
    本地拷贝，而revert不能。）</p>
</li>

<li><p>版本混杂。</p>

     <p>提交的时候，在客户端的工作拷贝中，只有此次提交涉及的节点会被更新，
     而不是所有节点。这意味着，你最后一次提交决定你的工作拷贝中了文件和目录
     的版本号，他们可能不是同一版本。对于像修改目录属性等特定操作，如果版本库
     中有更新的版本，你的提交会被拒绝，以防止数据丢失。详细请见<a
     href="http://svnbook.red-bean.com/svnbook/ch02s03.html#svn-ch-2-sect-3.4">
     版本混杂的局限</a>在<a
     href="http://svnbook.red-bean.com/">Version Control with
     Subversion</a>中。</p>

     <p>执行'svn update'可以解决这个问题。</p>
</li>

<li><p>你的版本可能确实是过时的&nbsp;&mdash;&nbsp;即在你提交的时候，有人基于你的
    上一次改动又作了更新。执行'svn update'来解决这个问题.</p>
</li>
</ol>
</div>


<div class="h3" id="obstructed-add" title="obstructed-add">
<h3>我向我的工程里添加了一个补丁，这个补丁添加了一个新文件，现在<tt>svn update</tt>不能工作了。</h3>

<p>In order to include your new file in the patch you likely ran the <tt>svn add</tt>
command so that the <tt>svn diff</tt> command would include the new file in the patch.
If your patch is committed to the code base and you run an <tt>svn update</tt>, then
you might receive an error message of: "svn: Failed to add file 'my.new.file':
object of the same name already exists".</p>

<p>The reason that you recieved this error is that you still have your local copy of
the file in your working copy.  The steps to correct this problem are:</p>

<ol>
	<li>Run the <tt>svn revert</tt> command to remove the scheduled add within
	Subversion.</li>
	<li>Delete the file or move it to a location outside your working copy.</li>
	<li>Now you should be able to run the <tt>svn update</tt> command.</li>
</ol>

<p>You might want to compare the new file from the repository with your original file.</p>
</div>


<div class="h3" id="unrecognized-url-error" title="unrecognized-url-error">
<h3>我编译了Subversion的发行版，当我试图check out的时候，我得到一个错误"Unrecognized URL scheme."这时怎么回事呢?</h3>

<p>Subversion使用了插件系统来访问版本库.现在支持三个插件:ra_local支持访问
本地版本库,ra_dav支持通过WebDAV访问版本库,ra_svn支持通过svnserver服务器访问
远程或本地的版本库.当你执行Subversion的操作时,会根据URL scheme来决定加载
哪一个插件.以`file://'开头的URL会加载ra_local,`http://'开头的URL会加载ra_dav.</p>

<p>你看到的错误是说无法找到正确的插件.发生这个问题,通常是因为你将Subversion的库文件
编译成动态库后,却没有执行'make install'.或者虽然你执行了'make install',但是
操作系统还是找不到Subversion的动态库所在的路径.在Linux系统中,你可以把相应的路径
加入到/etc/ld.so.conf中,然后运行ldconfig.如果你不想这么作,又或者你没有root权限,
你可以在LD_LIBRARY_PATH中指定相应的路径.</p>

</div>


<div class="h3" id="db-recover" title="db-recover">
<h3>I'm getting errors finding or opening a repository,
    but I know my repository URL is correct.  What's wrong?</h3> 

<p>See <a href="#bdb-recovery">this faq.</a></p>

</div>



<div class="h3" id="configure-sed-error" title="configure-sed-error">
<h3>当我运行`<tt>configure</tt>'命令时，出现一些错误
<tt>subs-1.sed&nbsp;line&nbsp;38:&nbsp;Unterminated&nbsp;`s'&nbsp;command</tt>。
这是怎么回事？</h3>

<p>
可能你系统里的
<tt>/usr/local/bin/apr-config</tt>和
<tt>/usr/local/bin/apu-config</tt>太旧了.删了它们,更新<tt>apr/</tt>和<tt>apr-util/</tt>,
使其和你编译的版本保持一致,再重新编译.
</p>

</div>

 
<div class="h3" id="windows-msvc-build" title="windows-msvc-build">
<h3>我在Windows下用MSVC++6.0构建Subversion时候有些麻烦，我该怎么办？</h3>

<p>
可能你需要最新版本的platform SDK.VC++ 6.0带的SDK太旧了.
</p>

</div>


<div class="h3" id="windows-drive-letter" title="windows-drive-letter">
<h3>我如何在<tt>file:</tt>格式的URL中指定Windows盘符?</h3>

<p>像这样:</p>
<pre>
svn import file:///d:/some/path/to/repos/on/d/drive
</pre>
<p>更多细节请见Subversion书中的<a
href="http://svnbook.red-bean.com/html-chunk/ch02s03.html#svn-ch-2-sidebar-1">
Repository URLs</a>.</p>

</div>

  
<div class="h3" id="vs-asp-net" title="vs-asp-net">
<h3>VS.NET/ASP.NET似乎不能处理".svn"目录名.我该怎么办?</h3>

<p>VS.Net有一个ASP.Net子系统,它使用WebDAV来通过IIS来远程发布.这个子系统
剔除了所有以"."开头的目录.在你试图远程发布你的工作目录的时候,".svn"将导致问题.
错误信息类似"unable to read project information".</p>

<p>要想绕过这个问题,设置环境变量SVN_ASP_DOT_NET_HACK为任意值 &nbsp;&mdash;&nbsp;
 这将告诉Windows clients在你的工作拷贝中使用"_svn"作为目录名.参见<a
href="http://subversion.tigris.org/svn_1.3_releasenotes.html#_svn-hack"
>Subversion 1.3 release notes的相关章节</a>来取得更多信息,参见
<a href="#adm-dir">这个问题</a>来用其他方法配置管理目录名.</p>

</div>


<div class="h3" id="write-over-dav" title="write-over-dav">
<h3>I'm having trouble doing write
    operations to a Subversion repository over a network.</h3>

<p>For example, one user reported that imports worked fine over local
access:</p>
<pre>
  $ mkdir test
  $ touch test/testfile
  $ svn import test file:///var/svn/test -m "Initial import"
  Adding         test/testfile
  Transmitting file data .
  Committed revision 1.
</pre>
But not from a remote host:
<pre>
  $ svn import http://svn.sabi.net/test testfile -m "import"
  nicholas's password: xxxxxxx

  svn_error: #21110 : &lt;Activity not found&gt;

  The specified activity does not exist.
</pre>

<p> We've seen this when the REPOS/dav/ directory is not writable by
the httpd process.  Check the permissions to ensure Apache can write
to the <tt>dav/</tt> directory (and to <tt>db/</tt>, of course).  </p>

</div>



<div class="h3" id="windows-xp-server" title="windows-xp-server">
<h3>Under Windows XP, the Subversion server
    sometimes seems to send out corrupted data.  Can this really
    be happening?</h3>

<p>You need to install Window XP Service Pack 1.  You can get all
sorts of information about that Service Pack here:</p>

    <ul><li>
    <a href="http://support.microsoft.com/default.aspx?scid=kb;EN-US;q317949"
    >http://support.microsoft.com/default.aspx?scid=kb;EN-US;q317949</a>
    </li></ul>

</div>


<a name="ethereal"></a> <!-- for compatibility with old question -->
<div class="h3" id="net-trace" title="net-trace">
<h3>What is the best method of doing a network
    trace of the conversation between a Subversion client and
    server?</h3>

<p>Use <a href="http://www.wireshark.org/">Wireshark</a> (formerly
known as "Ethereal") to eavesdrop on the conversation.</p>

<p>First, make sure that between captures within the same wireshark
session, you hit <em>Clear</em>, otherwise filters from one capture
(say, an HTTP capture) might interfere with others (say, an ra_svn
capture). </p>

<p>Assuming you're cleared, then:</p>

<ol>
<li><p>Pull down the <i>Capture</i> menu, and choose
    <i>Capture&nbsp;Filters</i>.</p></li>
<li><p>If debugging the http:// (WebDAV) protocol, then in the window
    that pops up, choose "<code>HTTP&nbsp;TCP&nbsp;port&nbsp;(80)</code>"
    (which should result in the filter string
    "<code><i>tcp&nbsp;port&nbsp;http</i></code>").</p>
    <p>If debugging the svn:// (ra_svn) protocol, then choose <i>New</i>,
    give the new filter a name (say, "ra_svn"), and type
    "<code>tcp&nbsp;port&nbsp;3690</code>" into the filter string box.</p>
    <p>When done, click OK.</p></li> 
<li><p>Again go to the <i>Capture</i> menu, this time choose
    <i>Interfaces</i>, and click <i>Options</i> next to the
    appropriate interface (probably you want interface "lo", for
    "loopback", assuming the server will run on the same machine as
    the client).</p></li>
<li><p>Turn off promiscuous mode by unchecking the appropriate
    checkbox.</p></li>
<li><p>Click the <i>Start</i> button in the lower right to start the
    capture.</p></li>
<li><p>Run your Subversion client.</p></li>
<li><p>Click the Stop icon (a red X over an ethernet interface card) when
    the operation is finished (or <i>Capture-&gt;Stop</i> should
    work).  Now you have a capture.  It looks like a huge list of
    lines.</p></li>
<li><p>Click on the <i>Protocol</i> column to sort.</p></li>
<li><p>Then, click on the first relevant line to select it; usually this
    is just the first line.</p></li>
<li><p>Right click, and choose <i>Follow TCP Stream</i>.  You'll be
    presented with the request/response pairs of the Subversion
    client's HTTP conversion.</p></li>
</ol>

<p>The above instructions are specific to the graphical version of
Wireshark (version 0.99.6), and don't apply to the command-line
version known as "tshark" (which corresponds to "tethereal", from back
when Wireshark was called Ethereal).</p>

<p>Alternatively, you may set the <tt>neon-debug-mask</tt> parameter in your
<tt>servers</tt> configuration file to cause neon's debugging output
to appear when you run the <tt>svn</tt> client.  The numeric value of
<tt>neon-debug-mask</tt> is a combination of the <tt>NE_DBG_...</tt> values
in the header file <tt>ne_utils.h</tt>.  For current versions of neon, setting
<tt>neon-debug-mask</tt> to 130 (i.e. <tt>NE_DBG_HTTP+NE_DBG_HTTPBODY)</tt>
will cause the HTTP data to be shown.</p>

<p>You may well want to disable compression when doing a network
trace&mdash;see the <tt>http-compression</tt> parameter in the <tt>servers</tt>
configuration file.</p>

<p>Another alternative is to set up a logging proxy between the
 Subversion client and server.  A simple way to do this is to use
 the <tt>socat</tt> program.  For example, to log communication with
 an svnserve instance, run the following command:</p>

<p><tt>socat -v  TCP4-LISTEN:9630,reuseaddr,fork
    TCP4:localhost:svn</tt></p>

<p>Then run your svn commands using an URL base
  of <tt>svn://127.0.0.1:9630/</tt>; <tt>socat</tt> will forward the
  traffic from port 9630 to the normal svnserve port (3690), and will
  print all traffic in both directions to standard error, prefixing it
  with &lt; and &gt; signs to show the direction of the traffic.</p>

</div>


<div class="h3" id="revert" title="revert">
<h3>Why does the <tt>svn revert</tt> require an
    explicit target?  Why is it not recursive by default?  These
    behaviors differ from almost all the other subcommands.</h3>

<p>The short answer: it's for your own good.</p>

<p>Subversion places a very high priority on protecting your data, and
not just your versioned data.  Modifications that you make to
already-versioned files, and new files scheduled for addition to the
version control system, must be treated with care.</p>

<p>Making the <tt>svn revert</tt> command require an explicit
target&mdash;even if that target is just '.'&mdash;is one way of
accomplishing that.  This requirement (as well as requiring you to
supply the <tt>--recursive (-R)</tt> flag if you want that behavior)
is intended to make you really think about what you're doing, because
once your files are reverted, your local modifications are gone
forever.</p>

</div>



<div class="h3" id="db3db4" title="db3db4">
<h3>When I start Apache, mod_dav_svn complains about
    a "bad database version", that it found db-3.X, rather than
    db-4.X.</h3>

<p>Your apr-util linked against DB-3, and svn linked against DB-4.
Unfortunately, the DB symbols aren't different.  When mod_dav_svn is
loaded into Apache's process-space, it ends up resolving the
symbol names against apr-util's DB-3 library.</p>

<p>The solution is to make sure apr-util compiles against DB-4.  You
can do this by passing specific switches to either apr-util's or
apache's configure: "--with-dbm=db4 --with-berkeley-db=/the/db/prefix".</p>

</div>



<div class="h3" id="redhat-db" title="redhat-db">
<h3>I'm getting "Function not implemented" errors on Red Hat
9, and nothing works.  How do I fix this?</h3>

<p>This is not really a problem with Subversion, but it often affects
Subversion users.</p>

<p>Red Hat 9 and Fedora ship with a Berkeley DB library that relies on
the kernel support for NPTL (the Native Posix Threads Library).</p>

<p>The kernels that Red Hat provides have this support built in, but if you
compile your own kernel, then you may well not have the NPTL support.  If that
is the case, then you will see errors like this:</p>
<blockquote><pre>
svn: Berkeley DB error
svn: Berkeley DB error while creating environment for filesystem tester/db:
Function not implemented
</pre></blockquote>
<p>This can be fixed in one of several ways:</p>
<ul>
<li>Rebuild Berkeley DB for the kernel you're using.</li>
<li>Use a Red Hat 9 kernel.</li>
<li>Apply the NPTL patches to the kernel you're using.</li>
<li>Use a recent (2.5.x) kernel with the NPTL support included.</li>
<li>Check if environment variable <code>LD_ASSUME_KERNEL</code> is set
    to <code>2.2.5</code>, and if so, unset it before starting
    Subversion (Apache). (You usually would set this variable to run
    Wine or Winex on Red Hat 9)</li>
</ul>
<p>To use the NPTL version of Berkeley DB you also need to use a glibc
library with NPTL support, which probably means the i686 version. See
<a
href="http://svn.haxx.se/users/archive-2004-03/0488.shtml">
http://svn.haxx.se/users/archive-2004-03/0488.shtml
</a> for details.
</p>

</div>


<div class="h3" id="no-author" title="no-author">
<h3>Why does SVN log say "(no author)" for files
    committed or imported via Apache (ra_dav)?</h3>

<p>If you allow anonymous write access to the repository via Apache,
the Apache server never challenges the SVN client for a username, and
instead permits the write operation without authentication.  Since
Subversion has no idea who did the operation, this results in a log
like this:</p>

<blockquote><pre>
$ svn log
------------------------------------------------------------------------
rev 24:&nbsp; (no author) | 2003-07-29 19:28:35 +0200 (Tue, 29 Jul 2003)
</pre></blockquote>

<p>See the Subversion Book (<a
href="http://svnbook.red-bean.com/book.html#svn-ch-5-sect-4"
>"Networking a Repository"</a>)
to learn about configuring access restrictions in Apache.</p>

</div>



<div class="h3" id="windows-access-denied" title="windows-access-denied">
<h3>I'm getting occasional "Access Denied"
errors on Windows.  They seem to happen at random.  Why?</h3>

<p>These appear to be due to the various Windows services that monitor
the filesystem for changes (anti-virus software, indexing services, the
COM+ Event Notification Service).  This is not really a bug in Subversion,
which makes it difficult for us to fix.  A summary of the current state of
the investigation is available <a href=
"http://svn.haxx.se/dev/archive-2003-10/0136.shtml">here</a>.
A workaround that should reduce the incidence rate for most people was
implemented in revision 7598; if you have an earlier version, please
update to the latest release.
</p>

</div>


<div class="h3" id="freebsd-hang" title="freebsd-hang">
<h3>On FreeBSD, certain operations (especially
    svnadmin create) sometimes hang.  Why?</h3>

<p>This is usually due to a lack of available entropy on the system.
You probably need to configure the system to gather entropy from
sources such as hard-disk and network interrupts.  Consult your system
manpages, specifically random(4) and rndcontrol(8) on how to effect
this change.</p>

</div>


<a name="301-error"></a> <!-- for compatibility with old
  non-XML-name-compliant fragment id -->
<div class="h3" id="http-301-error" title="http-301-error">
<h3>我可以通过浏览器访问到版本库，但是当我使用svn检出时却提示我“301 Moved Permanently”（永久转移）的错误，为什么？</h3>

<p>这意味着你的httpd.conf配置有问题，通常情况下，当你设置的Subversion虚拟目录同时存在不同的地方时会出现这样的错误。</p>

<p>例如，当你曾经将版本库导出为<tt>&lt;Location
/www/foo&gt;</tt>, 但是你又同时设置了你的版本库的根目录为/www，那么你就麻烦了。当你想访问/www/foo/bar的时候，apache根本不会知道你真正想要寻找的文件/foo/bar在哪，是在你设置的根目录里头，还是要调用mod_dav_svn模块从/www/foo版本库中去把/bar文件给取回来，通常Apache的处理行为是采取前者的方式，因此就会出现“永久转移”这样的错误了。</p>

<p>解决这个问题的办法就是确认你的版本库路径不会有重叠，或者存在其他网络共享可访问的路径里面。</p>

<p>出现这个问题还有一个可能的原因，就是在网站根目录存在一个和版本库的URL同名的文件（文件夹）。例如，假设你的WEB服务器的根目录设置在/var/www，你的Subversion版本库被放置在/home/svn/repo目录下，然后你在Apache下将该版本库的URL配置成<tt>http://localhost/myrepo</tt>。如果你这时又在/var/www下创建了一个myrepo的目录，那么同样会产生301的错误。</p>


</div>


<div class="h3" id="no-copy-history" title="no-copy-history">
<h3>我想要查看一个文件的旧版本，但是SVN却提示我“路径未找到”（Path not found）类似这样的信息，这是怎么回事？</h3>

<p>Subversion有一个比较良好的特性，就是它支持文件复制及改名，而且还保留着旧文件的历史记录。例如，如果你将/trunk目录拷贝到/branches/mybranch，那么版本库就知道，在branch分支中的每个文件都是从trunk目录中来的。运行svn log --verbose命令，我们就可以看到历史的拷贝记录，这个时候就可以观察到改名的行为了。如下所示：</p>

<pre>
r7932 | joe | 2003-12-03 17:54:02 -0600 (Wed, 03 Dec 2003) | 1 line
Changed paths:
   A /branches/mybranch (from /trunk:7931)
</pre>

<p>不幸的是，尽管版本库知道拷贝和重命名的行为，但是几乎所有的svn客户端命名并不能识别。如svn diff、svn merge还有svn cat等等这些命令本应该知道并跟踪这个改名的行为的，但是它们并没有做到这一点。这个问题已经被放在post-1.0特性的日程中了，你可以在<a
href="http://subversion.tigris.org/issues/show_bug.cgi?id=1093">issue
#1093</a>中查阅。  例如，当你让svn diff工具去比较/branches/mybranch/foo.c文件的两个早期版本时，这个命令并不会自动的识别出实际上要比较的是以前放在/trunk目录中的被重命名过的foo.c文件的两个早期版本。因此它会告诉你分支中的这个文件并不存在早期的版本。</p>

<p>所有这种类型的问题的解决方法就是自己多费点心，也就是说，你必须自己知道这些文件是改名过的，你可以通过使用svn log -v命令来发现这一点。然后你再把明确的告诉svn的客户端该怎么做。举个例子，如果你原来是打算运行下面这个命令的：</p>

<pre>
$ svn diff -r 1000:2000 http://host/repos/branches/mybranch/foo.c
svn: Filesystem has no item
svn: '/branches/mybranch/fooc..c' not found in the repository at revision 1000
</pre>

...那么你不得不改成下面这个方法来实现你的目的。
<pre>
$ svn diff -r1000:2000 http://host/repos/trunk/foo.c
...
</pre>

</div>


<div class="h3" id="digest-auth" title="digest-auth">
<h3>为什么HTTP摘要认证（HTTP Digest auth）不能正常工作？</h3>

<p>这个很可能是因为Apache服务器的一个已知的bug（存在于2.0.48或者更早期的版本），你可以在<a href="http://nagoya.apache.org/bugzilla/show_bug.cgi?id=25040"
   >http://nagoya.apache.org/bugzilla/show_bug.cgi?id=25040</a>找到相应的补丁。  你也可以在<a href="http://subversion.tigris.org/issues/show_bug.cgi?id=1608"
   >http://subversion.tigris.org/issues/show_bug.cgi?id=1608</a>
上看有没有已反馈的bug和你说的情况类似的。</p>

</div>


<div class="h3" id="xlc-compile" title="xlc-compile">
<h3>我在AIX上面编译xls的时候出现编译错误，为什么呢？</h3>

<p>在环境变量CFLAGS中加入 <tt>-qlanglvl=extended</tt> 作为配置参数，这会使到编译xls的时候更加灵活，这样应该不会再出现编译错误了。更详细的信息请参阅
<a href="http://svn.haxx.se/dev/archive-2004-01/0922.shtml"
>http://svn.haxx.se/dev/archive-2004-01/0922.shtml</a> 及相关的文章。</p>

</div>
 

<div class="h3" id="nonrecursive-checkout" title="nonrecursive-checkout">
<h3>我使用非递归的方式（使用 -N参数）检出一个目录后，现在我想让某些特定的子目录再“出现”，但svn up subdir命令不能正常使用。</h3>

<p>参考 <a
href="http://subversion.tigris.org/issues/show_bug.cgi?id=695">issue
695</a>.  当前的<tt>svn checkout -N命令的实现非常糟糕。它会造成工作拷贝某些条目缺失，但它本身又没有意识到已经出现了不完整性的问题。</tt>很显然，很多的CVS用户已经对这种使用方式习以为常了，但是Subversion的用户还并不习惯。目前还没有好的办法解决这个问题，只能让你自己改变操作的流程：先试着检出单独的子目录，然后再手动嵌入到你的工作拷贝中。</p>

</div>


<div class="h3" id="mod_dav_svn-win32" title="mod_dav_svn-win32">
<h3>我试着在win32平台的Apache上使用mod_dav_svn模块，但是却提示我模块未找到的错误，但是mod_dav_svn.so 这个文件明明就放在<tt>\Apache\modules目录中。</tt></h3>

<p>这个错误信息在这里有点误导人。通常这样的错误是因为Apache因为某些链接库dll依赖性的问题无法正确加载<tt>mod_dav_svn.so模块。如果当前Apache是以服务的形式运行的，那么它的path环境变量和普通用户的并不相同。请确认</tt><tt>libdb4*.dll、</tt><tt>intl3_svn.dll、</tt> <tt>libeay32.dll还有</tt><tt>ssleay32.dll</tt>都可以在<tt>\Apache\bin</tt>或者<tt>\Apache\modules</tt>目录中找到。如果没有找到，你可以从Subversion的安装目录下拷贝一份。</p>

<p>如果这样还解决不了问题的话，那么你可以使用类似<a href="http://www.dependencywalker.com">Dependency Walker</a>这样的工具来查看<tt>mod_dav_svn.so库的依赖性，看是否还有尚未解决的依赖性问题存在。</tt></p>

</div>


<a name="win32-hooks"></a> <!-- for compatibility with old question -->
<a name="hook-environment"></a> <!-- for yet more compatibility with old question -->
<div class="h3" id="hook-debugging" title="hook-debugging">
<h3>为什么我的钩子脚本都不能正常工作?</h3>

<p>这些钩子脚本应该会触发外部程序的，但是这个触发过程似乎并没有执行。</p>

<p>当Subversion调用一个钩子脚本时，它会将所有环境变量都清除干净，包括unix下的$Path和windows下的%Path%变量，因此，你的脚本如果要访问外部程序的话你就必须指定好外部程序的完整路径。</p>

<p><b>调试技巧:</b></p>
<p>
如果你正在运行Linux或者Unix操作系统，试一下按照下面的步骤手动运行一下脚本：</p>

  <ol>
            <li>使用 "su"、"sudo"或者类似的命令来切换到一般情况下可能会运行该脚本的用户。如果你运行的是Apache服务器的话，那么这个用户通常是httpd或者www-data。如果你运行svnserve的话，那么很可能是使用svn的帐户来运行该脚本。这样切换用户之后来运行脚本的好处就是不会再有脚本运行权限错误的问题出现            </li>
<li>
              使用env程序清除所有环境变量然后再运行该脚本，如下所示：
          <blockquote><pre>
                  $ env - ./post-commit /var/lib/svn-repos 1234
</pre></blockquote>
              注意到传递给env程序的第一个参数是一个横杠，这样可以保证环境变量为空。            </li>
    <li>
            查看控制台有没有输出错误信息。</li>
      </ol>

</div>


<div class="h3" id="diff-cmd" title="diff-cmd">
<h3>为什么我的--diff-cmd会有关于‘-u’的报错，我想用--extensions去覆盖它，但是不起作用。</h3>

<p>当使用一个外部的diff命令时，Subversion会生成一个非常复杂的命令行。第一个参数就是具体的--diff-cmd，然后就是具体的--extensions (尽管使用空白的 --符号时会忽略扩展), 或者如果没有指定--extensions或者--extensions为空的话，就加上‘-u’参数。第三和第四个参数，Subversion会传递一个“-L”还有第一个文件的标签（例如，“"project_issues.html    (revision 11209)”)。第五个和第六个就是另一个“-L”和第二个文件的标签。第七和第八个参数分别是第一个和第二个文件的名称（例如，“.svn/text-base/project_issues.html.svn-base”和“.svn/tmp/project_issues.html.tmp”）。</p>

<p>如果你指定的diff命令不支持这些参数的话，你可能需要创建一个简单的封装脚本来忽略这些参数，然后将最后的你需要的文件的路径参数传递给diff命令。</p>

<p>警告：Subversion并不希望外部的diff工具会改变它接收到的文件，否则可能会破坏当前工作拷贝。</p>

<p>更多信息请参考issue
<a href="http://subversion.tigris.org/issues/show_bug.cgi?id=2044">#2044</a>.</p>

</div>


<div class="h3" id="plaintext-passwords" title="plaintext-passwords">
<h3> 啊呀，我刚刚发现我的Subversion客户端居然把我的密码以明文的方式缓存在本地硬盘中！！！</h3>

<p>冷静一下，深呼吸。</p>

<p>在windows 2000及之后的版本上，svn 1.2之后的版本都使用标准的windows API来加密数据，所以只有用户自己能够解密出缓存的密码来。</p>

<p>在Mac OS X, svn 1.4以后的版本使用系统的keychain功能来加密以及存储svn的密码。</p>

<p>在UNIX/Linux,没有和加密相关的函数，所以密码保存在 ~/.subversion/auth/目录下。需要注意，这个包含缓存密码（通常是~/.subversion/auth/）的目录权限码是700，这意味着只有你自己才有权利读取他们。</p>

<p>要信任你的操作系统，让它来保护你磁盘上的数据。</p>

<p>尽管如此，如果你还是担心的话，那么你可以将密码缓存的功能永久关闭。在svn 1.0的客户端中，你只需要你的运行时配置文件设置‘store-auth-creds
= no’。对于svn 1.1以及之后的版本来说，你可以使用粒度更细的设置，'store-passwords = no' (这样服务器的证书还是会缓存）。更多关于密码缓存的信息已经放在<a 
href="http://svnbook.red-bean.com/nightly/en/index.html">下的“Nightly 
Build”Subversion书中</a>第六章的<a href="http://svnbook.red-bean.com/nightly/en/svn.serverconfig.netmodel.html#svn.serverconfig.netmodel.credcache">“Client Credentials Caching</a>下。</p>

<p>最后要说的是，我们知道CVS很多年来一直都是将缓存的密码存放在.cvspass文件中的。表面上来看存放在里面的数据是加密过的，但实际上，他们只是使用非常简单的算法来进行混淆，就像rot13一样。他们可以很轻易就被破解掉。这种混淆的唯一作用就是防止其他用户如管理员意外的看到密码。但是目前还没有人希望Subversion也这样做。如果你感兴趣的话，你可以为其写补丁然后发送到dev@ list。</p>

</div>


<div class="h3" id="bdb41-tabletype-bug" title="bdb41-tabletype-bug">
<h3>我得到一个错误&quot;svn: bdb: call      implies an access method which is inconsistent with previous      calls&quot;。我该如何修正它呢？</h3>

<p>Berkeley DB 4.1版本相当的不稳定，而4.0和4.2都相对比较稳定。这条错误信息就是4.1版本有时候发生问题时的提示信息。</p>

<p>这个问题是由于使用Berkeley数据库做支撑的Subversion版本库中的其中一张表的某个数据库格式化域（database format field）被破坏了。不知道什么原因，这通常都是因为“copies”表出错，导致它从“btree”类型转换成“recno”类型。你可以按照下面列的简单的恢复流程来处理。如果下面的步骤未能成功，你应该联系Subversion的用户邮件列表。</p>

<ul>
  <li>确保当前没有其他的进程在访问版本库。</li>
  <li>现在，将你的版本库备份到一个tar或者zip或者类似格式的文件中。</li>
  <li>转到你版本库的db子目录。</li>
  <li>执行删除指令：<tt>rm __db.* log.*</tt></li>
  <li>执行转储指令：<tt>db_dump -p -r copies &gt; copies.dump</tt></li>
  <li>现在编辑<tt>copies.dump</tt>文件，在最上面的内容中将“<tt>type=recno</tt>”改成 to “<tt>type=btree</tt>”, 然后删除以“re_len=”开头的行。</li>
  <li>执行删除指令：<tt>rm copies</tt></li>
  <li><tt>执行重加载指令：db_load copies &lt; copies.dump</tt></li>
  <li><tt>svnadmin dump .. &gt; ../../my-recovered.svndump</tt></li>
  <li>现在创建一个新的版本库，重新加载刚刚生成的转储文件（dump file），然后拷贝所有自定义的钩子脚本或者配置文件，最后查看一下最新的版本号是否是你期望的。</li>
</ul>

</div>


<div class="h3" id="hotcopy-large-repos" title="hotcopy-large-repos">
<h3>我无法热备份我的版本库，当文件大于2Gb时svnadmin会出错。</h3>

<p>早期版本的APR在0.9版本分支上，如果使用Apache 2.0.x和Subversion 1.x，那么对于大文件是没有支持的（2Gb以上）。在APR 0.9.5及以后的版本还有Apache 2.0.50及以后的版本中已经考虑到这个问题了，并做了修正。但是这个修正并不是针对所有操作系统的，而是只针对Linux。</p>

</div>


<div class="h3" id="hidden-log" title="hidden-log">
<h3>我看不到我刚刚提交的文件的日志记录，为什么呢？</h3>

<p>假设你在版本库上运行‘<tt>svn&nbsp;checkout</tt>’，并且获得了修订号为7的工作拷贝（aka，r7），其中有一个文件叫做foo.c。你对这个文件进行了修改并且提交了修改。那么这个时候会发生两件事情。</p>

<ul>
<li>服务器上的版本库升级到修改号为8。</li>
<li>在你的工作拷贝中，只有foo.c升级到修订号8，其他工作拷贝目录下的内容都保持在修订号7。</li>
</ul>

<p>现在你有了一个我们称为混合版本（<i>mixed revision）</i>的工作拷贝。其中一个文件修订号为8，其余的为7.只有在当你把所有文件都提交的时候修订号才会更新，或者你显式的运行‘<tt>svn&nbsp;update</tt>’。</p>

<pre>   $ svn -v status
   7        7 nesscg       .
   8        8 nesscg       foo.c
   $</pre>

<p>如果你运行‘<tt>svn&nbsp;log</tt>’命令但是没有传递任何参数，那么它会打印出当前目录下的日志信息（对应上面列表中的.）。既然目录版本号还是停留在第7次修订，那么你当然看不到第8次修订的日志信息了。</p>

<p>如果你想要查看最新的日志，可以按照下面的方法来做。</p>

<ol>
<li>运行‘<tt>svn&nbsp;log&nbsp;-rHEAD</tt>’。</li>
<li>运行‘<tt>svn&nbsp;log&nbsp;URL</tt>’，其中URL指向的就是版本库的路径。</li>
<li>运行<tt>‘svn&nbsp;log&nbsp;foo.c</tt>’直接获取之前修改的文件的日志信息。</li>
<li>将工作拷贝更新到第8次修订，然后在运行‘<tt>svn&nbsp;log</tt>’。</li>
</ol>

</div>


<div class="h3" id="bdb43-upgrade" title="bdb43-upgrade">
<h3>升级到Berkeley DB 4.3或更新的版本之后，版本库出错了。、</h3>

<p>在Berkeley DB 4.3之前, <tt>svnadmin recover</tt> 能够适当的将Berkeley DB的版本库进行升级。但是Berkeley DB 4.3版本中的一个行为的改变导致了现在的升级过程失败。</p>

<p>使用下面的流程来置换升级你目前基于Berkeley
DB 4.3 及之后版本之上的版本库：</p>

<ul>

<li>确认没有其他进程在访问你的版本库（停止Apache、svnserve、svnlook和svnadmin，显示通过file://的访问，等等）。</li>

<li>使用旧的<tt>svnadmin</tt>工具(即用来链接到老版本Berkeley DB上的):

  <ol>

  <li>修复版本库：‘<tt>svnadmin&nbsp;recover&nbsp;/path/to/repository</tt>’</li>

  <li>将当前版本库做一个备份。</li>

  <li>删除所有未使用的日志文件，你可以通过运行‘<tt>svnadmin&nbsp;list-unused-dblogs&nbsp;/path/to/repeository</tt>’来查看。</li>

  <li>删除共享内存的文件，它们应该位于版本库中的db子目录下，文件名形如<tt>__db.00*</tt>。</li>

  </ol>
</li>

</ul>


<p>现在版本库应该能够在Berkeley DB 4.3上正常使用了。</p>

</div>


<div class="h3" id="tiger-apr-0.9.6" title="tiger-apr-0.9.6">
<h3>当我通过http://从MacOS X 10.4 (Tiger)的平台上检出版本库的时候，为什么偶尔会得到一些不一致的错误？</h3>

<p>注意，这里假设版本库是运行在Apache 2.0.x之上。</p>

<p><a href="http://issues.apache.org/bugzilla/show_bug.cgi?id=34332"
> APR 0.9.6</a> 有个bug，当运行在Tiger上的时候会存在，当你尝试检出一个大于64KB的文件时会出现这个错误。这会导致检出失败，通常给出的错误信息都是不可预料的。下面是可能会出现的提示信息，你看到的可能不大一样。</p>

<pre>
   svn: Invalid diff stream: [tgt] insn 1 starts beyond the target view position
</pre>

<pre>
   svn: Unexpected end of svndiff input
</pre>

<pre>
   svn: REPORT request failed on '/path/to/repository'
   svn: REPORT of '/path/to/repository/!svn/vcc/default': Chunk delimiter was invalid
</pre>

<p>同样，在Apache的error_log日志中也会记录相应的错误，如:</p>

<pre>
   [error] Provider encountered an error while streaming a REPORT response.  [500, #0]
   [error] A failure occurred while driving the update report editor [500, #190004]
</pre>

<p>为了确认这个bug是否存在――假设你可以访问版本库所在的机器――尝试使用File://的方式来检出，这样就可以绕过Apache直接通过文件系统来访问了。如果这样检出成功的话，那么问题就出在上面提到的bug上。</p>

<p>目前最好的解决方案就是升级到APR 1.2.0+。</p>

<p>或者你也可以从各自的源里重新编译Apache还有Subversion，在运行Apache配置前先设置好相应的环境变量。</p>

<pre>
   setenv ac_cv_func_poll no
</pre>

<p>或者以Bourne shell 的语法，如下：</p>

<pre>
   ac_cv_func_poll=no; export ac_cv_func_poll
</pre>

<p>如果你分别编译APR / APRUTIL(例如，你并不想使用Apache发行包中的某些部分），你必须在配置APR之前设置好环境变量，因为这就是问题所在。</p>

</div>


<div class="h3" id="debian-libtool" title="debian-libtool">
<h3>我不能构建Subversion，我的工作拷贝源码在Debian GNU/Linux上，在链接阶段我得到了一些错误，哪里错了呢？</h3>
    
<p>如果你在编译Subversion主线源代码的最后一步出现了下面的错误：</p>

<pre>
   /usr/local/apache2/lib/libaprutil-0.so.0: undefined reference to `db_create'
   /usr/local/apache2/lib/libaprutil-0.so.0: undefined reference to `db_strerror'
</pre>

<p>那很可能是由于你使用的是Debian系统，你需要升级你的‘libtool’。（我听说Debian的打包者不得不做了一些小的改动来修正一些错误。这可能会导致Subversion编译的时候出现问题。但这只是猜测，在写这个FAQ条目的时候我并没有时间去验证一下细节的东西。你可以查看<a
href="http://subversion.tigris.org/servlets/ReadMsg?list=dev&amp;msgNo=112617"
>http://subversion.tigris.org/servlets/ReadMsg?list=dev&amp;msgNo=112617</a>
还有相关的帖子得到更详细的讨论。)</p>

<p>不管怎么样，如果你在2005年11月15号的时候在Debian GNU/Linux系统上面运行最新的testing发行版，然后遇到这个问题，那么解决方法就是，将libtool 1.5.20的源代码使用标准的“./configure &amp;&amp; make &amp;&amp;
sudo&nbsp;make&nbsp;install”重新编译。之后，我又对我的工作拷贝执行了一次“make clean”的清理，然后运行“./autogen.sh”, “./configure”,“make”,然后一切都正常了。</p>

<p>注意，有一个类似的反馈也已经发布在 <a
href="http://svn.haxx.se/dev/archive-2003-01/1125.shtml"
>http://svn.haxx.se/dev/archive-2003-01/1125.shtml</a>, 但是在上面却没有提到这个解决方案。</p>

</div>


<div class="h3" id="freebsd-listen-host" title="freebsd-listen-host">
<h3>我在使用FreeBSD，并且已经启动了svnserve，但是看起来并没有监听3690端口。</h3>
    
<p>一句话概括：使用--listen-host=0.0.0.0参数调用svnserveShort。</p>
<p>再具体一点，FreeBSD的守护进程默认情况下只监听tcp6。上面这个选项用来启用tcp4的监听。</p>
</div>

<div class="h3" id="already-under-version-control" title="already-under-version-control">
<h3>我不能添加一个目录，因为Subversion说“它已经处于版本控制了”。</h3>
<p>那是因为你要添加的目录已经包含了.svn的目录了，但那个目录是来自其他的版本库中而不是你当前正在添加的版本库。这种现象很可能就是因为你使用了操作系统的拷贝功能直接从另外一个工作拷贝上复制到当前工作拷贝。</p>
<p>
  比较快但是又不雅的解决方案就是删除你想添加的文件夹下所有的.svn目录，然后add命令就可以顺利执行了。如果你使用的是Unix，你可以使用下面的命令：</p>
<pre>
  find dir -type d -name .svn -exec rm -rf {} \;
</pre>
<p>但是你应该清楚知道，你自己为什么要复制这个文件夹，同时也要确认你不会往版本库中添加任何你不期望添加的拷贝。</p>

</div>

<div class="h3" id="slow-private-svnserve" title="slow-private-svnserve">
<h3>有时候通过svnserve访问一个非公开的版本库实在是太慢了。</h3>

<p>当编译APR时使用/dev/random设备，服务器没有办法获取足够的内存量的时候这个问题经常会出现。如果服务器上只有Subversion在使用APR，那么你可以安全的重新编译APR，编译的时候带上参数 <tt>--with-devrandom=/dev/urandom</tt> 。当然，如果有其他进程在使用APR的时候，那么你就不能这样来做了，否则会造成其他服务不安全。</p>

</div>

<div class="h3" id="ssl-negotiation-error" title="ssl-negotiation-error">
<h3>当执行的Subversion操作需要通过SSL传递大量数据的时候，碰到一个错误SSL negotiation failed: SSL error: decryption failed or bad      record mac。</h3>

<p>这个错误可能是由于OpenSSL 0.9.8版本的问题。你可以下载早期不存在此问题的版本（或者可能的话，升级到更新的版本）。</p>

</div>

<div class="h3" id="broken-subclipse" title="broken-subclipse">
<h3>我得到一个错误&quot;This client is too      old&quot;。（客户端版本太旧）</h3>

如果你正在同时使用很老的（1.4以前的）Subversion命令行客户端还有Subclipse，然后你最近更新了Subclipse，接着你的命令行客户端提示你：
<pre>
svn: This client is too old to work with working copy
'/path/to/your/working/copy'; please get a newer Subversion client
</pre>

这是因为Subversion工作拷贝的格式发生了不兼容的改动――新版本的Subclipse对你的工作拷贝做了升级，所以你的命令行客户端程序，因为是版本比较老的，所以无法读取其内容。（这个问题并不只是存在于Subclipse上，也有可能是当你同时使用另外一个1.4以后的新版本的时候，旧版本的程序也会出现类似的问题）你可以简单的把你的命令行客户端升级到1.4及之后的版本。</div>

<div class="h3" id="switch-problems" title="switch-problems">
<h3>为什么有时候svn switch不能工作？</h3>

<p>有时候，工作拷贝中包含了一些未被纳入版本控制的文件，这个时候svn switch就会发生错误。switch的过程就会停止，这会导致工作拷贝一半被switch另一半却保持原样。</p>

<p>不幸的是，如果这个时候你采取的措施不正确的话，那么你的工作拷贝将会不能使用。有时候，svn会提示用户执行清理（svn cleanup）。但清理命令又有可能造成错误。参考：<a
href="http://subversion.tigris.org/issues/show_bug.cgi?id=2505">issue
      #2505</a>。</p>
<p>用户可以手动的删除那些造成问题的文件或目录，然后再执行清理命令，接着继续swich，这样便可以恢复。</p>

<p>Note that a switch from a <i>pristine</i> clean checkout always
works without error.  There are three ways of working if you are using
<tt>svn switch</tt> as part of your development process:</p>

<ol>

<li>Fully clean your working copy of unversioned (including ignored)
files before switching. <br/><b>WARNING! This deletes all unversioned
dirs/files. Be VERY sure that you do not need anything that will be
removed.</b>

<blockquote>
<div><pre><code>
# Check and delete svn unversioned files: 
svn status --no-ignore | grep '^[I?]' | sed 's/^[I?]//'
svn status --no-ignore | grep '^[I?]' | sed 's/^[I?]//' | xargs rm -rf
</code></pre></div>
</blockquote>

</li>

<li>Keep a <i>pristine</i> clean checkout. Update that, then copy it,
and switch the copy when a switch to another branch is desired.</li>

<li>Live dangerously :).
 Switch between branches without cleaning up BUT if you encounter a switch error
 know that you have to recover from this properly.
 Delete the unversioned files and the directory that the error was reported on.
 Then "svn cleanup" if needed and then resume the switch.
 Unless you delete <em>all</em> unversioned files, you may have to repeat this
 process multiple times.</li>

</ol>

<p>Some examples are detailed 
<a href="http://subversion.tigris.org/issues/show_bug.cgi?id=2505">here in issue 2505</a>.
The problem is that the svn client plays it 
safe and doesn't want to delete anything unversioned. 
</p>

<p>Two specific examples are detailed here to illustrate a problem like this.
There are also other svn switch errors, not covered here, which you
  can avoid by switching only from a <em>pristine</em> checkout.</p>

<ol>

<li>If any directory has been moved or renamed between the branches, then
anything unversioned will cause a problem.
In this case, you'll see this error:
<br/>
<blockquote>
<div><pre><code>
wc/$ svn switch $SVNROOT/$project/branches/$ticket-xxx
svn: Won't delete locally modified directory '&lt;dir&gt;'
svn: Left locally modified or unversioned files
</code></pre></div>
</blockquote>
<p>Removing all unversioned files, and continuing the switch will recover from this.</p>
</li>

<li>If a temporary build file has ever been added and removed, then a switch
in a repository with that unversioned file (likely after a build) fails. 
You'll see the same error:

<blockquote>
<div><pre><code>
wc/$ svn switch $SVNROOT/$project/branches/$ticket-xxx
svn: Won't delete locally modified directory '&lt;dir&gt;'
svn: Left locally modified or unversioned files
</code></pre></div>
</blockquote>

<p>In this case, just removing the unversioned items will not recover.
A cleanup fails, but svnswitch directs you to run "svn cleanup".</p>

<blockquote>
<div><pre><code>
wc/$ svn switch $SVNROOT/$project/branches/$ticket-xxx
svn: Directory '&lt;dir&gt;/.svn' containing working copy admin area is missing
wc/$ svn cleanup
svn: '&lt;dir&gt;' is not a working copy directory
wc/$ svn switch $SVNROOT/$project/branches/$ticket-xxx
svn: Working copy '.' locked
svn: run 'svn cleanup' to remove locks (type 'svn help cleanup' for details)
</code></pre></div>
</blockquote>

<p>Removing the directory (and all other unversioned files, to prevent
 "switch" from breaking on a similar error repeatedly), and continuing the switch
 will recover from this.</p>
</li>

</ol>

<p>The TortoiseSVN cleanup error is a bit different.  You might encounter this:
</p>
<blockquote>
<div><pre><code>
Subversion reported an error while doing a cleanup!
&lt;dir&gt;/&lt;anotherdir&gt; is not a working copy directory
</code></pre></div>
</blockquote>

<p>In each case here, the "svn switch" breaks leaving you with a half-switched 
working copy. "svn status" will show items with S for switched items (different
 from top directory), ! for directories with problems, and ~ for the files that are
 the problem (and with maybe L for locked). Like this:</p>
<blockquote>
<div><pre><code>
wc/$ svn status 
!      .
!      &lt;dir&gt;
    S  &lt;switched_things&gt;
~      &lt;dir&gt;/&lt;thing_that_is_now_unversioned&gt;
</code></pre></div>
</blockquote>

</div>

<div class="h3" id="long-paths" title="long-paths">
<h3>在Windows平台上，通过命令行客户端的执行更新操作时，我碰到一个错误&quot;The      system cannot find the path specified&quot;，并且提示说我的工作拷贝可能损坏了，但是我能通过TortoiseSVN更新时完全正常，这是怎么回事呢？ </h3>

<p>仔细研究了windows关于文件命名的API文档才发现造成这一问题的最常见原因。简单的说，当你使用unicode版本的windows和路径相关的函数时，你可以指定的路径长度比较长，而且提供了绝对路径定位，而不是相对路径定位。幸运的是Subversion使用的Apache Portable Runtime（APR）库透明的对这种绝对路径（如<tt>C:\WorkingCopy\file.txt</tt>）进行了转换，将其转换成符合windows API要求的格式（\\<tt>?\C:\WorkingCopy\file.txt</tt>），这种转换也可以反向。不幸的是，你只有在使用绝对路径的时候才享用了这些长路径的好处。</p>

<p>要查看路径长度是不是造成你所遇到的问题，你可以在Subversion命令行客户端下使用绝对路径代替相对路径（或者根本不提供）。换句话说，如果你原先是这么做的：</p>

<blockquote>
<div><pre><code>
C:\> svn up WorkingCopy
</code></pre></div>
</blockquote>

<p>或者这样做的：</p>

<blockquote>
<div><pre><code>
C:\> cd C:\WorkingCopy
C:\WorkingCopy> svn up
</code></pre></div>
</blockquote>

<p>把它改成下面这样的方式</p>

<blockquote>
<div><pre><code>
C:\> svn update C:\WorkingCopy
</code></pre></div>
</blockquote>

<p>如果问题解决了，那么恭喜你――你已经成功突破了windows的路径长度限制，并且现在你已经知道怎么解决这个问题了。</p>

<p><strong>为什么这个问题不会影响TortoiseSVN呢？</strong>
因为TortoiseSVN<em> 永远 </em>对SubversionAPI提供的全都是绝对路径。</p>

<p><strong>那为什么Subversion命令行客户端不是永远都把输入转换成绝对路径，然后使用绝对路径呢？Why, then, does the Subversion command-line client not
always convert its input into absolute paths and use those?</strong>
Subversion的开发者在开发的时候基于一个原则，那就是处于对用户体验的考虑，在工具的输出中显示的路径必须匹配输入的路径的语法。如果输入的相对路径转换到绝对路径没有太多价值的话，那么这个转换处于复杂性考虑就去掉了。（换句话说，这是一个比较难的问题，当不是一个比较迫切的问题）。</p>

</div>

<div class="h3"
     id="working-copy-format-change" title="working-copy-format-change">
<h3>我碰到一个错误&quot;This      client is too old to work with working copy '...' &quot;，不升级Subversion能够解决吗？</h3>

<p>有时候在次版本改动的发行包下，工作拷贝中的元信息格式也会发生不兼容的改变。例如，假设你使用Subversion1.4.4创建了一个工作拷贝，但有一天你绝地你使用一下1.5.0。但后来你又想将其改成1.4.4，这个时候就出错了――提示信息就如你所描述的。</p>

<p>这是因为1.5.0将你的工作拷贝升级到可以支持新特性的格式（例如，修改列表,keep-local标志，variable-depth目录）尽管1.4.4并不知道任何这些特性，但它能够识别出来，工作拷贝里面使用的格式已经被升级到一个新的它不能支持的版本。</p>

<p>1.5.0升级工作拷贝处于一个好的原因，那就是它知道1.4.4现在并不了解工作拷贝的任何元信息，因此如果让1.4.4的版本去干扰工作拷贝中的元数据，那么重要的信息可能会丢失，很有可能会造成破坏（例如你可以参考<a
href="http://subversion.tigris.org/issues/show_bug.cgi?id=2961" >issue
#2961</a>）。</p>

<p>但是这种自动升级的行为在当你想要尝试一个新版本但是又不想永久安装时，挺让人讨厌的。出于这一点的考虑，我们发布了一个脚本，用来安全的对工作拷贝进行版本降级。你可以在下面的地址下载到：</p>

<blockquote>
<p><a
href="http://svn.collab.net/repos/svn/trunk/tools/client-side/change-svn-wc-format.py"
>http://svn.collab.net/repos/svn/trunk/tools/client-side/change-svn-wc-format.py</a></p>
</blockquote>

<p>使用--help参数调用此脚本，可以查看怎么运行脚本。未来Subversion新版本发布时，我们会尽量更新这个FAQ条目，使他覆盖到更多的降级的场景。</p>

</div>

<div class="h3"
     id="relocation-against-local-symbol"
     title="relocation-against-local-symbol">
<h3>当我在64位Linux上编译Neon库时，发生一个错误&quot;relocation R_X86_64_32 against `a local symbol' can not be used      when making a shared object&quot;。</h3>

<p>Neon库，是用来作为Subversion服务器和HTTP客户端进行通讯的库，通常被编译成静态库。但是它后来被链接到不同的动态链接库中，这会导致在AMD 64位操作系统系统上面编译的过程出现错误，出现类似下面的信息：</p>

<blockquote>
<div><pre><code>
subversion-1.4.6/neon/src/.libs/libneon.a(ne_request.o): relocation R_X86_64_32
against `a local symbol' can not be used when making a shared object;
recompile with -fPIC
/home/jrandom/subversion/subversion-1.4.6/neon/src/.libs/libneon.a: could not
read symbols: Bad value
</code></pre></div>
</blockquote>

<p>在开发者邮件列表中有一篇文章提到了这一点。</p>

<p>解决方法就是为Subversion的配置脚本提供一个“--enable-shared”的参数。</p>

</div>

</div>

<div class="h2" id="developer-questions" title="developer-questions">
<h2>Developer questions:</h2>
<p/>

<div class="h3" id="ramdisk-tests" title="ramdisk-tests">
<h3>怎样在RAM磁盘上进行回归测试？</h3>

<p>如果将Subversion的测试数据保存在RAM磁盘上，那么测试的过程将会变得非常快。在Linux系统上，你可以直接将RAM磁盘挂载：</p>

<blockquote>
<div><code>mount -t tmpfs tmpfs
/path/to/src/subversion/tests/cmdline/svn-test-work
-o uid=$USER,mode=770,size=32m</code></div>
</blockquote>

<p>或者，如果要更长期的挂载，可以将下面这一行添加到你的<code>/etc/fstab</code>文件中:</p>

<blockquote>
<div><code>tmpfs  /path/to/src/svn/subversion/tests/cmdline/svn-test-work
tmpfs  defaults,user,noauto,exec,size=32m</code></div>
</blockquote>

<p>RAM磁盘空间至少为大约700MB。尽管如此，你还是可以通过清理测试目标来大大降低空间需求（在上面的配置例子中我们已经看到了）还有你的内存占用。清理意味着占用更多的IO资源，, 但是由于测试数据还是存在于内存中的，因此不会造成任何性能的下降。</p>

<blockquote><div><code>
make check CLEANUP=true
</code></div></blockquote>

<p>参考 <a href="http://svn.haxx.se/dev/archive-2003-02/0068.shtml"
>http://svn.haxx.se/dev/archive-2003-02/0068.shtml</a> 可以看到更多关于RAM磁盘使用的权威讨论。</p>

</div>


<div class="h3" id="dynamic-exe-debugging" title="dynamic-exe-debugging">

<h3>怎样在不安装的情况下对动态Subversion库运行调试器？</h3>

<p>在往unix-y系统上运行make install这一步之前，动态编译Subversion源代码Before the <code>make install</code> step on unix-y systems,
dynamically built "executables" in a Subversion source tree are
actually libtool-generated shell scripts which re-link and run the
real binary.  As shown below, this complicates debugging:</p>

<blockquote>
<div><code>subversion$ gdb subversion/svn/svn</code></div>
<div><code>... "/path/to/subversion/subversion/svn/svn": not in
executable format: File format not recognized</code></div>
</blockquote>

<p>While this can be worked around by building using the
<code>--disable-shared</code> argument to configure to statically link
the binaries, or installing them and pointing your debugger at the
installed version, it's often necessary or more expedient to be able
to debug them right within your source tree.</p>

<p>To do so, edit the last <code>exec</code> statement in the shell
script to run the real binary in your debugger.  With gdb, this
amounts to replacing <code>exec "$progdir/$progname"</code> with
<code>exec gdb --args "$progdir/$progname"</code>.</p>

<p>This trick is also very useful when applied to the
libtool-generated shell scripts for the white box tests.</p>

</div>


<div class="h3" id="avoiding-compiler-inlining"
title="avoiding-compiler-inlining">

<h3>怎样让编译器不内联混淆（inlining obfuscating）源代码的情况下对Subversion库运行调试器？</h3>

<p>默认情况下，gcc会经常优化那些私有变量及函数，还有相关的操作。这样会造成调试的时候跟进一段代码变得更复杂。</p>

<p>unix-y systems上的解决办法就是在make这一步的时候将这个优化过程关闭。</p>

<blockquote>
<div><code>subversion$ make EXTRA_CFLAGS=-O0</code></div>
</blockquote>

<p>（那是一个横杠加两个字母的O）。你也可以通过运行下面的配置使到以后自动这样设置：</p>

<blockquote>
<div><code>subversion$ ./configure --enable-debug</code></div>
</blockquote>

<p>对于产品的安装来说，要记住在从源码安装Subversion时撤销这个操作，你可以通过重新不附加任何参数来运行make或者configure以撤销上面的修改操作。</p>

</div>


</div>

<div class="h2" id="references" title="references">
<h2>References:</h2>
<p/>

<div class="h3" id="http-methods" title="http-methods">
<h3>Subversion用到的HTTP方法是有哪些？</h3>

<p>Subversion 客户端使用WebDAV/DeltaV 协议的一个子集来作为 mod_dav_svn server 模块的一部分。简而言之：</p>

<pre>
     OPTIONS, PROPFIND, GET, REPORT,
     MKACTIVITY, PROPPATCH, PUT, CHECKOUT, MKCOL,
     MOVE, COPY, DELETE, LOCK, UNLOCK, MERGE
</pre>

<p>关于协议的细节问题可以在下面这个链接找到相应的文档：</p>

<a href="http://svn.collab.net/repos/svn/trunk/notes/webdav-protocol">http://svn.collab.net/repos/svn/trunk/notes/webdav-protocol</a>



</div>


<div class="h3" id="bikeshed" title="bikeshed">
<h3>什么是'bikeshed'？</h3>

<p>参阅 Poul-Henning Kamp的关于freebsd-hackers的帖子: <a href="http://www.freebsd.org/doc/en_US.ISO8859-1/books/faq/misc.html#BIKESHED-PAINTING">http://www.freebsd.org/doc/en_US.ISO8859-1/books/faq/misc.html#BIKESHED-PAINTING</a>.
</p>

</div>


<div class="h3" id="pronounce" title="pronounce">
<h3>你是怎样读&quot;Subversion&quot;的？</h3>

<p>Jim Blandy设计了Subversion的名字和版本库的设计，把“Subversion”读作 <a href="http://svn.collab.net/repos/svn-committers/trunk/sounds/pronunciation/index.html">“Subversion”。</a></p>

</div>


<div class="h3" id="baton" title="baton">
<h3>什么是'baton'？</h3>

<p>在Subversion的源代码中有很多引用指向‘baton’对象。他们只是一些对象。有很多void *的数据结构作为某个函数的上下文。在另外一些API里，他们通常通过void *ctx或者void *userdata来调用的，就像Subversion的开发者通过“batons”数据结构来调用一样，但是更省资源。</p>

</div>


<div class="h3" id="def-wedged-repository" title="def-wedged-repository">
<h3>当你说版本库是'楔住（wedged）'的时候，是什么意思？</h3>

<p>被楔住版本库:</p>

<blockquote>
<p>一个Subversion版本库由两个不同的内部组件组成，一个是用来工作的，一个是用来存储的。一个楔住的版本库指的是出于未知的原因，版本库的工作区不能访问了，但是存储区是完整的。因此，一个楔住的版本库并不会丢失任何数据，但是在你正常访问版本库之前工作区必须修复好。参阅 <a href="#stuck-bdb-repos">this</a> 条目查看具体怎么去修复。</p>
</blockquote>

<p>被破坏了的版本库：</p>

<blockquote>
<p>一个被破坏了的版本库指的是存储区已经被破坏了，因此版本库中的数据可能多多少少会有丢失。</p>
</blockquote>

<p>你可能需要查看Jargon File关于‘<a href="http://catb.org/~esr/jargon/html/W/wedged.html">wedged’</a>的定义。</p>

</div>

</div>

</div>
</body>
</html>
